"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
ylab("Speed (mm/s)") + xlab("Species")+
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1,vjust=1))
speed_annotated %>% filter(!is.na(Species) & Architecture != "Whorl chain") %>%
ggplot(aes(x = factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y=Speed_mms_abs)) + geom_jitter(alpha=0.2, aes(col=Architecture)) + geom_boxplot(aes(fill=Architecture))+guides(fill = "none")+
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
ylab("Speed (mm/s)") + xlab("Species")+
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1,vjust=1))
speed_annotated %>% filter(!is.na(Species) & Architecture != "Whorl chain") %>%
ggplot(aes(x = factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y=Speed_mms_abs)) + geom_jitter(alpha=0.2, aes(col=Architecture)) + geom_boxplot(aes(fill=Architecture))+guides(fill = "none")+
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) + scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
+                                "Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
F2A <- speed_annotated %>% filter(!is.na(Species) & Architecture != "Whorl chain") %>%
ggplot(aes(x = factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y=Speed_mms_abs)) + geom_boxplot(aes(fill=Architecture))+guides(fill = "none") + geom_jitter(alpha=0.2, aes(color= Architecture))+
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
ylab("Speed (mm/s)") + xlab("Species")+
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1,vjust=1))
F2A
F6B
F2A <- speed_annotated %>% filter(!is.na(Species) & Architecture != "Whorl chain") %>%
ggplot(aes(x = factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y=Speed_mms_abs)) + geom_boxplot(aes(fill=Architecture))+guides(fill = "none") +
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
ylab("Speed (mm/s)") + xlab("Species")+
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1,vjust=1))
F2A
F2A <- speed_annotated %>% filter(!is.na(Species) & Architecture != "Whorl chain") %>%
ggplot(aes(x = factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y=Speed_mms_abs)) + geom_boxplot(aes(fill=Architecture))+guides(fill = "none") + geom_jitter(alpha=0.2, aes(color= Architecture))+
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
ylab("Speed (mm/s)") + xlab("Species")+
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1,vjust=1))
F2A
F5D
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
stat_summary(fun = "mean", geom = "bar", position = "dodge") +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
stat_summary(fun = "mean", geom = "bar", position = "dodge") +
geom_jitter(aes(alpah=0.2,color=Architecture))+
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
stat_summary(fun = "mean", geom = "bar", position = "dodge") +
geom_jitter(aes(alpha=0.2,color=Architecture))+
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
stat_summary(fun = "mean", geom = "bar", position = "dodge") +
geom_jitter(aes(alpha=0.5,color=Architecture))+
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
stat_summary(fun = "mean", geom = "bar", position = "dodge") +
geom_jitter(aes(alpha=0.5))+
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
#COT by biovolume per bodylength across Species
F5D <- ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
stat_summary(fun = "mean", geom = "bar", position = "dodge") +
geom_jitter(aes(color=Architecture),alpha=0.5)+
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
F5A
F5D
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
stat_summary(fun = "mean", geom = "bar", position = "dodge") +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
geom_jitter(aes(color=Architecture),alpha=0.5)+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
geom_jitter(aes(color=Architecture),alpha=0.5)+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
geom_jitter(aes(color=Architecture),alpha=0.9)+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.9)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.abs.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.abs.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.9)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.abs.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.abs.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.5)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.abs.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.abs.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.7)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y=COT.rel.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.7)+
stat_summary(fun = "mean", geom = "bar", position = "dodge") +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+ guides(fill="none",color="none")+
xlab("Species")
ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y=COT.rel.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.7)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+ guides(fill="none",color="none")+
xlab("Species")
ggplot(COT_with_means %>%
filter(COT.abs.ml>-1000000 & Architecture != "Whorl chain"),
aes(factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y=COT.abs.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.7)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per mm moved)") + guides(fill="none",color="none")+
xlab("Species")
architecture_order <- c("Transversal", "Linear", "Bipinnate", "Whorl", "Cluster","Helical")
F5A <- ggplot(COT_with_means %>%
filter(COT.abs.ml>-1000000 & Architecture != "Whorl chain"),
aes(factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y=COT.abs.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.7)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per mm moved)") + guides(fill="none",color="none")+
xlab("Species")
#### Figure 5B #####
#COT by biovolume per bodylength across Species
F5B <- ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y=COT.rel.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.7)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+ guides(fill="none",color="none")+
xlab("Species")
#### Figure 5C #####
architecture_order <- c("Transversal", "Linear", "Bipinnate", "Whorl", "Cluster","Helical")
F5C <- ggplot(COT_with_means %>%
filter(COT.abs.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.abs.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.7)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
#### Figure 5D #####
#COT by biovolume per bodylength across Species
F5D <- ggplot(COT_with_means %>%
filter(COT.rel.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.rel.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.9)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
wrap_plots(F5A, F5B, F5C, F5D)
F6B
ggplot(COT_with_means %>%
filter(COT.abs.ml > -10 & Architecture != "Whorl chain"),
aes(x = BLperSecond, y = COT.rel.ml)) +
geom_smooth(method = "lm", color = "black", formula = y ~ log(x)) +
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_point(data = COT_with_means %>% filter(COT.abs.ml > -10 & Architecture != "Whorl chain"),
aes(x = BLperSecond, y = COT.rel.ml, col = Architecture),
width = 0.2, height = 0, alpha = 0.2) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
ylab("Cost of Transport (pgO2/ml per zooid length moved)") +
xlab("Speed (zooids/s)") +
theme_bw() +
ylim(0, NA)
F6A <- ggplot(COT_with_means %>%
filter(COT.abs.ml > -10 & Architecture != "Whorl chain"),
aes(x = Speed_mm_s, y = COT.abs.ml)) +
geom_smooth(method = "lm", color = "black", formula = y ~ log(x)) +
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_point(data = COT_with_means %>% filter(COT.abs.ml > -10 & Architecture != "Whorl chain"),
aes(x = Speed_mm_s, y = COT.abs.ml, col = Architecture),
width = 0.2, height = 0, alpha = 0.2) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
ylab("Cost of Transport (pgO2/ml per mm moved)") +
xlab("Speed (mm/s)") +
theme_bw() +
ylim(0, NA) +
guides(color = "none")
##### Figure 6B #####
#COT by biovolume per cm across relative speeds
F6B <- ggplot(COT_with_means %>%
filter(COT.abs.ml > -10 & Architecture != "Whorl chain"),
aes(x = BLperSecond, y = COT.rel.ml)) +
geom_smooth(method = "lm", color = "black", formula = y ~ log(x)) +
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_point(data = COT_with_means %>% filter(COT.abs.ml > -10 & Architecture != "Whorl chain"),
aes(x = BLperSecond, y = COT.rel.ml, col = Architecture),
width = 0.2, height = 0, alpha = 0.2) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
ylab("Cost of Transport (pgO2/ml per zooid length moved)") +
xlab("Speed (zooids/s)") +
theme_bw() +
ylim(0, NA)
wrap_plots(F6A, F6B)
speed_annotated %>%
filter(!is.na(Species) & Architecture != "Whorl chain" & !is.na(BLperPulse)) %>% mutate(CSAmode = case_when(
Architecture %in% c("Transversal", "Cluster", "Whorl", "Oblique") ~ "Scaling Frontal Area",
Architecture %in% c("Linear", "Bipinnate", "Helical") ~ "Constant Frontal Area",
TRUE ~ as.character(Architecture)
)) %>%
group_by(CSAmode) %>%
ggplot(aes(Zooid.number, BLperPulse)) +
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
geom_smooth(col = "black", method = 'lm', se = TRUE) +  # Add regression line
theme_bw() +
ylab("Speed (zooids/pulse)")+
xlab("Number of zooids")+
facet_wrap(~CSAmode, scales = "free_x")
speed_annotated %>%
filter(!is.na(Species) & Architecture != "Whorl chain" & !is.na(BLperPulse)) %>% mutate(CSAmode = case_when(
Architecture %in% c("Transversal", "Cluster", "Whorl", "Oblique") ~ "Scaling Frontal Area",
Architecture %in% c("Linear", "Bipinnate", "Helical") ~ "Constant Frontal Area",
TRUE ~ as.character(Architecture)
)) %>%
group_by(CSAmode) %>%
ggplot(aes(Zooid.number, BLperPulse)) +
geom_point(alpha=0.5,aes(color=Architecture))+
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
geom_smooth(col = "black", method = 'lm', se = TRUE) +  # Add regression line
theme_bw() +
ylab("Speed (zooids/pulse)")+
xlab("Number of zooids")+
facet_wrap(~CSAmode, scales = "free_x")
## means with crossbars relative speed #
DVR <- speed_dvzs %>%
filter(!is.na(Speed_mms_abs)) %>%
group_by(Species, Architecture) %>%
summarise(
mean_Dorsoventral_Zooid_Stolon_Angle = mean(Dorsoventral_Zooid_Stolon_Angle, na.rm = TRUE),
mean_BLperPulse = mean(BLperPulse, na.rm = TRUE),
sd_BLperPulse = sd(BLperPulse, na.rm = TRUE)
) %>%
ggplot(aes(x = mean_Dorsoventral_Zooid_Stolon_Angle, y = mean_BLperPulse, col = Architecture)) +
geom_smooth(method = 'lm', se = TRUE, color = "black") +
geom_point(cex = 3) +
geom_errorbar(aes(ymin = mean_BLperPulse - sd_BLperPulse, ymax = mean_BLperPulse + sd_BLperPulse), width = 2.5, position = position_dodge(0.2)) +
geom_point(data = speed_dvzs %>% filter(!is.na(Speed_mms_abs)), aes(x = Dorsoventral_Zooid_Stolon_Angle, y = BLperPulse), width = 0.2, height = 0.2, alpha = 0.3) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw() +
xlab("Dorsoventral Zooid Rotation Angle") +
ylab("Speed (body lengths/pulsation)")
DVA <- DVA <- speed_dvzs %>%
filter(!is.na(Speed_mms_abs)) %>%
group_by(Species, Architecture) %>%
summarise(
mean_Dorsoventral_Zooid_Stolon_Angle = mean(Dorsoventral_Zooid_Stolon_Angle, na.rm = TRUE),
mean_Speed_mm_s = mean(Speed_mms_abs, na.rm = TRUE),
sd_Speed_mm_s = sd(Speed_mms_abs, na.rm = TRUE)
) %>%
ggplot(aes(x = mean_Dorsoventral_Zooid_Stolon_Angle, y = mean_Speed_mm_s, col = Architecture)) +
geom_smooth(method = 'lm', se = TRUE, color = "black") +
geom_point(cex = 3) +
geom_errorbar(aes(ymin = mean_Speed_mm_s - sd_Speed_mm_s, ymax = mean_Speed_mm_s + sd_Speed_mm_s), width = 2.5, position = position_dodge(0.2)) +
geom_point(data = speed_dvzs %>% filter(!is.na(Speed_mms_abs)), aes(x = Dorsoventral_Zooid_Stolon_Angle, y = Speed_mms_abs), width = 0.2, height = 0.2, alpha = 0.3) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw() +
xlab("Dorsoventral Zooid Rotation Angle") +
ylab("Speed (mm/s)") +
guides(color = "none")
wrap_plots(DVA,DVR)
