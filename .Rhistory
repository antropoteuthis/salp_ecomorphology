selectivity_melt$Species <- factor(selectivity_melt$Species, levels=SPorder[which(SPorder %in% selectivity_melt$Species)])
IDorder <- unique(arrange(selectivity_melt, Species)$Specimen)
selectivity_melt$Specimen <- factor(selectivity_melt$Specimen, levels=IDorder)
selectivity_melt$Prey <- factor(selectivity_melt$Prey, levels=PreyOrderTr)
names(selectivity_melt)[3]<-"Selectivity"
selectivity_melt[,4] <- as.numeric(selectivity_melt[,4])
selectivity_spp <- aggregate(selectivity_melt$L.I.~selectivity_melt$Selectivity+selectivity_melt$Species, FUN=function(x){mean(x,na.rm = T)})
names(selectivity_spp) <- c("Prey","Species","L.I.")
GCspecies_melt$Species[which(!(GCspecies_melt$Species %in% selectivity_spp$Species))] %>% unique() -> missing_spp
expand.grid(unique(selectivity_spp$Prey),missing_spp)->missing_entries
missing_entries <- cbind(missing_entries, rep(NA, nrow(missing_entries)))
names(missing_entries) <- names(selectivity_spp)
selectivity_spp <- rbind(selectivity_spp, missing_entries)
lit <- read.csv("siphweb_metabarcoding/Literature-data/allinteractions.tsv", sep="\t", stringsAsFactors = F)
ROV_lit <- lit[which(lit$source %in% c("Pugh2009cResomiidae", "Choy_2017", "Hissman2005_newrho")),]
ROV_lit$Predator[which(ROV_lit$Predator=="Apolemia")] <- "Apolemia sp"
ROV_lit$Predator[which(ROV_lit$Predator=="Bargmannia")] <- "Bargmannia elongata" #according to Steve June 02, 4.39PM
ROV_lit$Predator[which(ROV_lit$Predator=="Forskalia")] <- "Forskalia sp."
ROV_lit$Predator[which(ROV_lit$Predator=="Nanomia bijuga")] <- "Nanomia sp. deep"
ROV_pruned <- ROV_lit[which(ROV_lit$Predator %in% unique(meltedGC$Species)),]
ROV_pruned$Predator <- factor(ROV_pruned$Predator, levels=SPorder)
GC_lit <- lit[which(!(lit$source %in% c("Pugh2009cResomiidae", "Choy_2017", "Hissman2005_newrho"))),]
GC_lit$Predator[which(GC_lit$Predator=="Nanomia bijuga" & GC_lit$source=="Biggs1977b_Feeding")] <- "Nanomia sp. Atlantic"
GC_lit$Prey_broad[which(GC_lit$Predator=="Nanomia sp. Atlantic" & GC_lit$source=="Biggs1977b_Feeding")] <- "Mysid"
GC_lit$Predator[which(GC_lit$Predator=="Nanomia bijuga" & GC_lit$source=="Purcell1981b_feeding")] <- "Nanomia sp. shallow"
GC_lit$Predator[which(GC_lit$Predator=="Apolemia uvaria")] <- "Apolemia sp" #questionable choice...
GC_lit$Predator[which(GC_lit$Predator=="Forskalia edwardsi")] <- "Forskalia sp."
GC_lit$Predator[which(GC_lit$Predator=="Forskalia tholoides")] <- "Forskalia sp."
GC_lit <- GC_lit[which(GC_lit$Prey != "Crustacea"),]
GC_pruned <- GC_lit[which(GC_lit$Predator %in% unique(meltedGC$Species)),]
MorphDAPC <- read.csv("siphweb_metabarcoding/Literature-data/DAPCdiet_posteriors.tsv", sep="\t", stringsAsFactors = F)
#MorphDAPC <- MorphDAPC[which(MorphDAPC$Species %in% unique(meltedGC$Species)),]
meltedMorph <- melt(MorphDAPC)
names(meltedMorph)[2:3] <- c("Prey","Predicted")
meltedMorph$Species[which(meltedMorph$Species=="Physonect sp")] <- "Undescribed physonect L"
meltedMorph$Species[which(meltedMorph$Species=="Forskalia formosa")] <- "Forskalia sp."
meltedMorph$Species[which(meltedMorph$Species=="Forskalia asymmetrica")] <- "Forskalia sp."
meltedMorph$Species[which(meltedMorph$Species=="Forskalia edwardsii")] <- "Forskalia sp."
morph <- rbind(mutate(meltedMorph[which(meltedMorph$Prey == "Large.crustacean"),], Prey_extrapolate="Decapod"),
mutate(meltedMorph[which(meltedMorph$Prey == "Large.crustacean"),], Prey_extrapolate="Euphausid"),
mutate(meltedMorph[which(meltedMorph$Prey == "Large.crustacean"),], Prey_extrapolate="Mysid"),
mutate(meltedMorph[which(meltedMorph$Prey == "Large.crustacean"),], Prey_extrapolate="Lophogastrid"),
mutate(meltedMorph[which(meltedMorph$Prey == "Large.crustacean"),], Prey_extrapolate="Stomatopod"),
mutate(meltedMorph[which(meltedMorph$Prey == "Large.crustacean"),], Prey_extrapolate="Amphipod"),
mutate(meltedMorph[which(meltedMorph$Prey == "Small.crustacean"),], Prey_extrapolate="Copepod"),
mutate(meltedMorph[which(meltedMorph$Prey == "Small.crustacean"),], Prey_extrapolate="Cladoceran"),
mutate(meltedMorph[which(meltedMorph$Prey == "Small.crustacean"),], Prey_extrapolate="Ostracod"),
mutate(meltedMorph[which(meltedMorph$Prey == "Fish"),], Prey_extrapolate="Actinopteri"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Actinopteri"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Decapod"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Euphausid"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Mysid"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Lophogastrid"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Stomatopod"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Amphipod"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Copepod"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Cladoceran"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Ostracod"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Mollusc"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Polychaete"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Chaetognath"),
mutate(meltedMorph[which(meltedMorph$Prey == "Mixed"),], Prey_extrapolate="Larvacean"),
mutate(meltedMorph[which(meltedMorph$Prey == "Gelatinous"),], Prey_extrapolate="Gelatinous")
)
morph <- cbind(morph[,c(1,4,3)],rep("Morphology",nrow(morph)))
names(morph) <- c("Species","Prey","N","Source")
metabar <- cbind(GCspecies_melt, rep("Metabarcoding",nrow(GCspecies_melt)))
names(metabar) <- c("Species","Prey","N","Source")
lit_deep <- cbind(ROV_pruned[,c(1,4,6)], rep("Literature_Deep",nrow(ROV_pruned)))
names(lit_deep) <- c("Species","Prey","N","Source")
lit_shallow <- cbind(GC_pruned[,c(1,4,6)], rep("Literature_Shallow",nrow(GC_pruned)))
names(lit_shallow) <- c("Species","Prey","N","Source")
sources_combo <- rbind(metabar, lit_deep, lit_shallow)
sources_combo$Prey[which(sources_combo$Prey == "Fish")]<-"Actinopteri"
sources_combo$Prey[which(sources_combo$Prey == "Euphausiid")]<-"Euphausid"
#sources_combo$N[which(sources_combo$N == 0)]<-NA
sources_combo=sources_combo[which(sources_combo$Prey != "Crustacea"),]
sources_combo$Prey[which(sources_combo$Prey == "Salp")]<-"Gelatinous"
sources_combo$Prey[which(sources_combo$Prey == "Hydrozoa")]<-"Gelatinous"
sources_combo$Prey[which(sources_combo$Prey == "Medusae")]<-"Gelatinous"
sources_combo$Prey[which(sources_combo$Prey == "Scyphomedusa")]<-"Gelatinous"
sources_combo$Prey[which(sources_combo$Prey == "Scyphozoa")]<-"Gelatinous"
sources_combo$Prey[which(sources_combo$Prey == "Ctenophore")]<-"Gelatinous"
sources_combo$Prey[which(sources_combo$Prey == "Bivalve")]<-"Mollusc"
sources_combo$Prey[which(sources_combo$Prey == "Gastropod")]<-"Mollusc"
sources_combo$Prey[which(sources_combo$Prey == "Cephalopod")]<-"Mollusc"
sources_combo$N[which(sources_combo$N != 0)]<-1
PreyOrderComb <- c("Copepod","Decapod","Euphausid","Mysid","Lophogastrid","Stomatopod","Amphipod","Cladoceran","Ostracod","Mollusc","Polychaete","Chaetognath","Gelatinous","Larvacean","Actinopteri")
sources_combo$Prey <- factor(sources_combo$Prey,levels=PreyOrderComb)
sources_combo_nulls_M <- sources_combo
sources_combo_nulls_M$N <- 0
sources_combo_nulls_M$Source <- "Metabarcoding"
sources_combo_nulls_D <- sources_combo_nulls_M
sources_combo_nulls_D$Source <- "Literature_Deep"
sources_combo_nulls_S <- sources_combo_nulls_D
sources_combo_nulls_S$Source <- "Literature_Shallow"
sources_combo <- rbind(sources_combo,sources_combo_nulls_M,sources_combo_nulls_D,sources_combo_nulls_S)
#sources_combo <- unique(sources_combo)
morph <- morph[which(morph$Species %in% sources_combo$Species),]
#Supplementary compoplots
ref_samples <- allsamples[which(!(allsamples$Interpretation %in% c("Short","Unknown"))),]
ref_samples$Interpretation[which(ref_samples$Interpretation == "Cross")] <- "Contamination"
getwd()
ggplot(ref_samples, aes(x = paste(Species, Specimen), y = log(abundance), fill = Broad.group)) + geom_bar(position = "fill",stat = "identity") + theme_bw() + theme(legend.key.size = unit(1,"line"), legend.text = element_text(size=5),legend.position="bottom", axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(values=c(colorRampPalette(brewer.pal(8, "Set2"))(16), colorRampPalette(brewer.pal(8, "Set1"))(16), colorRampPalette(brewer.pal(8, "Dark2"))(23))) + guides(shape = guide_legend(override.aes = list(size = 1)))
ref_samples
ref_samples$Specimen
ref_samples$Specimen %>% unique()
pdf("SM_ind_broadgroup.pdf", width = 20, height = 10)
ggplot(ref_samples, aes(x = paste(Species, Specimen), y = log(abundance), fill = Broad.group)) + geom_bar(position = "fill",stat = "identity") + theme_bw() + theme(legend.key.size = unit(1,"line"), legend.text = element_text(size=5),legend.position="bottom", axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(values=c(colorRampPalette(brewer.pal(8, "Set2"))(16), colorRampPalette(brewer.pal(8, "Set1"))(16), colorRampPalette(brewer.pal(8, "Dark2"))(23))) + guides(shape = guide_legend(override.aes = list(size = 1)))
dev.off()
#specimens by broad group and barcode
pdf("SM_ind_broadgroup_barcode.pdf", width = 20, height = 30)
ggplot(ref_samples, aes(x = paste(Species, Specimen), y = log(abundance), fill = Broad.group)) + geom_bar(position = "fill",stat = "identity") + theme_bw() + theme(legend.key.size = unit(1,"line"), legend.text = element_text(size=5),legend.position="bottom", axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(values=c(colorRampPalette(brewer.pal(8, "Set2"))(16), colorRampPalette(brewer.pal(8, "Set1"))(16), colorRampPalette(brewer.pal(8, "Dark2"))(23))) + guides(shape = guide_legend(override.aes = list(size = 1))) + facet_wrap(.~barcode, nrow=6, ncol=1)
dev.off()
#specimens by interpretation
pdf("SM_ind_interpretation.pdf", width = 20, height = 10)
ggplot(ref_samples, aes(x = paste(Species, Specimen), y = log(abundance), fill = Interpretation)) + geom_bar(position = "fill",stat = "identity") + theme_bw() + theme(legend.key.size = unit(1,"line"), legend.text = element_text(size=5),legend.position="bottom", axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(values=c(colorRampPalette(brewer.pal(8, "Set2"))(8))) + guides(shape = guide_legend(override.aes = list(size = 1))) + guides(shape = guide_legend(override.aes = list(size = 1)))
dev.off()
#specimens by interpretation and barcode
pdf("SM_ind_interpretation_barcode.pdf", width = 20, height = 30)
ggplot(ref_samples, aes(x = paste(Species, Specimen), y = log(abundance), fill = Interpretation)) + geom_bar(position = "fill",stat = "identity") + theme_bw() + theme(legend.key.size = unit(1,"line"), legend.text = element_text(size=5),legend.position="bottom", axis.text.x = element_text(angle = 90, hjust = 1)) + scale_fill_manual(values=c(colorRampPalette(brewer.pal(8, "Set2"))(8))) + guides(shape = guide_legend(override.aes = list(size = 1))) + guides(shape = guide_legend(override.aes = list(size = 1))) + facet_wrap(.~barcode, nrow=6, ncol=1)
dev.off()
library(tidyverse)
library(wql)
library(patchwork)
setwd("Documents/salp_ecomorphology/")
#Load data and label control rows
presens <- read.csv("respirometry_Kona21.tsv", header = T, sep = "\t", stringsAsFactors = F)
presens$Species[which(is.na(presens$Species))] <- "Control"
presens$Specimen[which(is.na(presens$Specimen))] <- "Control"
#Filter by plastic and intact treatments
presens <- presens[which(presens$Container=="Plastic" & presens$Treatment == "Intact"),]
#Correct for O2 saturation limit wit temperature
presens$Temperature...C.[which(is.na(presens$Temperature...C.))]<-29 #### MAKING SHIT UP ####
presens <- mutate(presens, sat_O2 = O2..mg.L./oxySol(presens$Temperature...C., 30.1, 1))
#Subset controls and specimen measures
controls <- presens[which(presens$Specimen=="Control"),]
specimens <- presens[which(presens$Specimen != "Control"),]
#Join Specimens+COntrols and subtract for specific O2 measurements
join_presens <- full_join(specimens, controls[-c(2:10,14,16:18)], by=c("Experiment","Time.point..min."), suffix=c("_animal","_control"))
names(join_presens)
join_presens <- mutate(join_presens, O2..mg.L.specific = O2..mg.L._animal-O2..mg.L._control, sat_O2.specific = sat_O2_animal - sat_O2_control)
#Extract T0 points and calculate relative O2 values
t_zeros <- join_presens[which(join_presens$Time.point..min.==0),c("Specimen","Species","O2..mg.L._animal", "O2..mg.L._control","O2..mg.L.specific", "sat_O2_control", "sat_O2_animal", "sat_O2.specific")]
dif_presens <- full_join(join_presens, t_zeros, by=c("Species","Specimen"), suffix=c("","T0"))
dif_presens <- mutate(dif_presens, dif_O2.animal = O2..mg.L._animal-O2..mg.L._animalT0, dif_O2.control = O2..mg.L._control-O2..mg.L._controlT0, dif_O2.specific = O2..mg.L.specific-O2..mg.L.specificT0, dif_sat_O2.animal = sat_O2_animal-sat_O2_animalT0, dif_sat_O2.control = sat_O2_control-sat_O2_controlT0, dif_sat_O2.specific = sat_O2.specific-sat_O2.specificT0)
#Correct for zooid length and number
norm_presens <- mutate(dif_presens, corr_O2.animal = dif_O2.animal/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids), corr_O2.control = dif_O2.control, corr_O2.specific = dif_O2.specific/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids), corr_sat_O2.animal = dif_sat_O2.animal/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids), corr_sat_O2.control = dif_sat_O2.control, corr_sat_O2.specific = dif_sat_O2.specific/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids))
#Remove unorthodox measuements
norm_presens <- norm_presens[which(norm_presens$Specimen != "D4-CP-B-1"),] #remove weird C.polae from MGCL2 experiment
norm_presens <- norm_presens[which(norm_presens$corr_O2.specific < 0),] #something has to have gone wrong in these datapoints
#Factorize specimen and species concepts
norm_presens$Specimen <- as.factor(norm_presens$Specimen)
norm_presens$Species <- as.factor(norm_presens$Species)
setwd("Documents/salp_ecomorphology/")
getwd()
setwd("~/Documents/salp_ecomorphology/")
#Load data and label control rows
presens <- read.csv("respirometry_Kona21.tsv", header = T, sep = "\t", stringsAsFactors = F)
presens$Species[which(is.na(presens$Species))] <- "Control"
presens$Specimen[which(is.na(presens$Specimen))] <- "Control"
#Filter by plastic and intact treatments
presens <- presens[which(presens$Container=="Plastic" & presens$Treatment == "Intact"),]
#Correct for O2 saturation limit wit temperature
presens$Temperature...C.[which(is.na(presens$Temperature...C.))]<-29 #### MAKING SHIT UP ####
presens <- mutate(presens, sat_O2 = O2..mg.L./oxySol(presens$Temperature...C., 30.1, 1))
#Subset controls and specimen measures
controls <- presens[which(presens$Specimen=="Control"),]
specimens <- presens[which(presens$Specimen != "Control"),]
#Join Specimens+COntrols and subtract for specific O2 measurements
join_presens <- full_join(specimens, controls[-c(2:10,14,16:18)], by=c("Experiment","Time.point..min."), suffix=c("_animal","_control"))
names(join_presens)
join_presens <- mutate(join_presens, O2..mg.L.specific = O2..mg.L._animal-O2..mg.L._control, sat_O2.specific = sat_O2_animal - sat_O2_control)
#Extract T0 points and calculate relative O2 values
t_zeros <- join_presens[which(join_presens$Time.point..min.==0),c("Specimen","Species","O2..mg.L._animal", "O2..mg.L._control","O2..mg.L.specific", "sat_O2_control", "sat_O2_animal", "sat_O2.specific")]
dif_presens <- full_join(join_presens, t_zeros, by=c("Species","Specimen"), suffix=c("","T0"))
dif_presens <- mutate(dif_presens, dif_O2.animal = O2..mg.L._animal-O2..mg.L._animalT0, dif_O2.control = O2..mg.L._control-O2..mg.L._controlT0, dif_O2.specific = O2..mg.L.specific-O2..mg.L.specificT0, dif_sat_O2.animal = sat_O2_animal-sat_O2_animalT0, dif_sat_O2.control = sat_O2_control-sat_O2_controlT0, dif_sat_O2.specific = sat_O2.specific-sat_O2.specificT0)
#Correct for zooid length and number
norm_presens <- mutate(dif_presens, corr_O2.animal = dif_O2.animal/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids), corr_O2.control = dif_O2.control, corr_O2.specific = dif_O2.specific/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids), corr_sat_O2.animal = dif_sat_O2.animal/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids), corr_sat_O2.control = dif_sat_O2.control, corr_sat_O2.specific = dif_sat_O2.specific/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids))
#Remove unorthodox measuements
norm_presens <- norm_presens[which(norm_presens$Specimen != "D4-CP-B-1"),] #remove weird C.polae from MGCL2 experiment
norm_presens <- norm_presens[which(norm_presens$corr_O2.specific < 0),] #something has to have gone wrong in these datapoints
#Factorize specimen and species concepts
norm_presens$Specimen <- as.factor(norm_presens$Specimen)
norm_presens$Species <- as.factor(norm_presens$Species)
rawControl <- ggplot(norm_presens, aes(x=Time.point..min., y=O2..mg.L._control)) + geom_point(aes(col=Species)) + ylab("O2 (mg/L) controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
rawAnimal <- ggplot(norm_presens, aes(x=Time.point..min., y=O2..mg.L._animal)) + geom_point(aes(col=Species)) + ylab("O2 (mg/L) animals") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
rawSpecific <- ggplot(norm_presens, aes(x=Time.point..min., y=O2..mg.L.specific)) + geom_point(aes(col=Species)) + ylab("O2 (mg/L) animals-controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw()
rawSatControl <- ggplot(norm_presens, aes(x=Time.point..min., y=sat_O2_control)) + geom_point(aes(col=Species)) + ylab("Sat O2 (%) Controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
rawSatAnimal <- ggplot(norm_presens, aes(x=Time.point..min., y=sat_O2_animal)) + geom_point(aes(col=Species)) + ylab("Sat O2 (%) (mg/L) Animals") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
rawSatSpecific <- ggplot(norm_presens, aes(x=Time.point..min., y=sat_O2.specific)) + geom_point(aes(col=Species)) + ylab("Sat O2 (%) Animals-Controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw()
RelControl <- ggplot(norm_presens, aes(x=Time.point..min., y=dif_O2.control)) + geom_point(aes(col=Species)) + ylab("O2 (mg/L) from T0 - Controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
RelAnimal <- ggplot(norm_presens, aes(x=Time.point..min., y=dif_O2.animal)) + geom_point(aes(col=Species))+ ylab("O2 (mg/L) from T0 - Animals") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
RelSpecific <- ggplot(norm_presens, aes(x=Time.point..min., y=dif_O2.specific)) + geom_point(aes(col=Species))+ ylab("O2 (mg/L) from T0 - Animals-Controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw()
RelSatControl <- ggplot(norm_presens, aes(x=Time.point..min., y=dif_sat_O2.control)) + geom_point(aes(col=Species)) + ylab("Sat O2 (%) from T0 - Controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
RelSatAnimal <- ggplot(norm_presens, aes(x=Time.point..min., y=dif_sat_O2.animal)) + geom_point(aes(col=Species))+ ylab("Sat O2 (%) from T0 - Animals") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
RelSatSpecific <- ggplot(norm_presens, aes(x=Time.point..min., y=dif_sat_O2.specific)) + geom_point(aes(col=Species))+ ylab("Sat O2 (%) from T0 - Animals-Controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw()
CorrControl <- ggplot(norm_presens, aes(x=Time.point..min., y=corr_O2.control)) + geom_point(aes(col=Species)) + ylab("Corrected O2 (mg/L) from T0 - Controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
CorrAnimal <- ggplot(norm_presens, aes(x=Time.point..min., y=corr_O2.animal)) + geom_point(aes(col=Species))+ ylab("Corrected O2 (mg/L) from T0 - Animals") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
CorrSpecific <- ggplot(norm_presens, aes(x=Time.point..min., y=corr_O2.specific)) + geom_point(aes(col=Species)) + ylab("Corrected O2 (mg/L) from T0 - Animals-Controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw()
CorrSatControl <- ggplot(norm_presens, aes(x=Time.point..min., y=corr_sat_O2.control)) + geom_point(aes(col=Species)) + ylab("Corrected Sat O2 (%) from T0 - Controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
CorrSatAnimal <- ggplot(norm_presens, aes(x=Time.point..min., y=corr_sat_O2.animal)) + geom_point(aes(col=Species))+ ylab("Corrected Sat O2 (%) from T0 - Animals") + geom_line(aes(col = Species, group=Specimen)) + theme_bw() + theme(legend.position = "none")
CorrSatSpecific <- ggplot(norm_presens, aes(x=Time.point..min., y=corr_sat_O2.specific)) + geom_point(aes(col=Species)) + ylab("Corrected Sat O2 (%) from T0 - Animals-Controls") + geom_line(aes(col = Species, group=Specimen)) + theme_bw()
slopes <- as.data.frame(matrix(ncol=3,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Slope")
for(i in 1:length(unique(norm_presens$Specimen))){
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Time.point..min.","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- lm_i$coefficients[2] %>% as.numeric()
}
### COST OF TRANSPORT ###
swim <- data.frame(species=c("Pegea confoederata","Iasis (Weelia) cylindrica","Cyclosalpa affinis"),Speed.cm.s=c(1.68,1.23,1.72),Speed.body.s=c(NA,NA,NA))
swim_presens <- norm_presens
### COST OF TRANSPORT ###
swim <- data.frame(Species=c("Pegea confoederata","Iasis (Weelia) cylindrica","Cyclosalpa affinis"),Speed.cm.s=c(1.68,1.23,1.72),Speed.body.s=c(NA,NA,NA))
swim_presens <- norm_presens
left.join(norm_presens, swim, by="Species")
left_join(norm_presens, swim, by="Species")
### COST OF TRANSPORT ###
swim <- data.frame(Species=c("Pegea confoederata","Iasis (Weelia) cylindrica","Cyclosalpa affinis"),Speed.cm.s=c(1.68,1.23,1.72))
swim_presens <- left_join(norm_presens, swim, by="Species") %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10)
swim_presens
swim <- data.frame(Species=c("Pegea confoederata","Iasis (Weelia) cylindrica","Cyclosalpa affinis"),Speed.cm.s=c(1.68,1.23,1.72))
swim_presens <- left_join(norm_presens, swim, by="Species") %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10)
swim_presens
names(norm_presens)
names(slopes)
slopes <- as.data.frame(matrix(ncol=4,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Slope_O2sat","Slope_CorrO2sat")
for(i in 1:length(unique(norm_presens$Specimen))){
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Time.point..min.","sat_O2.specific","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~sat_O2.specific, series_i)
lm_j <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients);print(lm_j$coefficients)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- lm_i$coefficients[2] %>% as.numeric()
slopes[i,4] <- lm_j$coefficients[2] %>% as.numeric()
}
ggplot(slopes,aes(x=Species,y=Slope_CorrO2sat))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(slopes,aes(x=Species,y=Slope_O2sat))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
slopes
slopes <- as.data.frame(matrix(ncol=6,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Zooid.length..mm.","Zooid.number","Slope_O2sat","Slope_CorrO2sat")
i=1
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Zooid.number","Time.point..min.","sat_O2.specific","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~sat_O2.specific, series_i)
lm_j <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
norm_presens
#Estimate slopes
slopes <- as.data.frame(matrix(ncol=6,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Zooid.length..mm.","Number.of.zooids","Slope_O2sat","Slope_CorrO2sat")
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Number.of.zooids","Time.point..min.","sat_O2.specific","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~sat_O2.specific, series_i)
lm_j <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients);print(lm_j$coefficients)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- series_i$Zooid.length..mm.[1] %>% as.character()
slopes[i,4] <- series_i$Number.of.zooids[1] %>% as.character()
slopes[i,5] <- lm_i$coefficients[2] %>% as.numeric()
slopes[i,6] <- lm_j$coefficients[2] %>% as.numeric()
slopes
slopes <- as.data.frame(matrix(ncol=6,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Zooid.length..mm.","Number.of.zooids","Slope_O2sat","Slope_CorrO2sat")
for(i in 1:length(unique(norm_presens$Specimen))){
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Number.of.zooids","Time.point..min.","sat_O2.specific","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~sat_O2.specific, series_i)
lm_j <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients);print(lm_j$coefficients)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- series_i$Zooid.length..mm.[1] %>% as.character()
slopes[i,4] <- series_i$Number.of.zooids[1] %>% as.character()
slopes[i,5] <- lm_i$coefficients[2] %>% as.numeric()
slopes[i,6] <- lm_j$coefficients[2] %>% as.numeric()
}
### COST OF TRANSPORT ###
swim <- data.frame(Species=c("Pegea confoederata","Iasis (Weelia) cylindrica","Cyclosalpa affinis"),Speed.cm.s=c(1.68,1.23,1.72))
COT <- left_join(slopes, swim, by="Species") %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10)
left_join(slopes, swim, by="Species")
COT <- left_join(slopes, swim, by="Species")
sapply(COT,class)
COT$Zooid.length..mm. <- as.numeric(COT$Zooid.length..mm.)
COT$Number.of.zooids <- as.numeric(COT$Number.of.zooids)
COT %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10)
COT %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10) -> COT
slopes <- as.data.frame(matrix(ncol=6,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Zooid.length..mm.","Number.of.zooids","Slope_O2","Slope_CorrO2sat")
for(i in 1:length(unique(norm_presens$Specimen))){
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Number.of.zooids","Time.point..min.","O2.specific","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~sat_O2.specific, series_i)
lm_j <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients);print(lm_j$coefficients)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- series_i$Zooid.length..mm.[1] %>% as.character()
slopes[i,4] <- series_i$Number.of.zooids[1] %>% as.character()
slopes[i,5] <- lm_i$coefficients[2] %>% as.numeric()
slopes[i,6] <- lm_j$coefficients[2] %>% as.numeric()
}
names(norm_presens)
slopes <- as.data.frame(matrix(ncol=6,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Zooid.length..mm.","Number.of.zooids","Slope_O2","Slope_CorrO2sat")
for(i in 1:length(unique(norm_presens$Specimen))){
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Number.of.zooids","Time.point..min.","O2..mg.L.specific","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~sat_O2.specific, series_i)
lm_j <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients);print(lm_j$coefficients)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- series_i$Zooid.length..mm.[1] %>% as.character()
slopes[i,4] <- series_i$Number.of.zooids[1] %>% as.character()
slopes[i,5] <- lm_i$coefficients[2] %>% as.numeric()
slopes[i,6] <- lm_j$coefficients[2] %>% as.numeric()
}
slopes <- as.data.frame(matrix(ncol=6,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Zooid.length..mm.","Number.of.zooids","Slope_O2","Slope_CorrO2sat")
for(i in 1:length(unique(norm_presens$Specimen))){
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Number.of.zooids","Time.point..min.","O2..mg.L.specific","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~O2..mg.L.specific, series_i)
lm_j <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients);print(lm_j$coefficients)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- series_i$Zooid.length..mm.[1] %>% as.character()
slopes[i,4] <- series_i$Number.of.zooids[1] %>% as.character()
slopes[i,5] <- lm_i$coefficients[2] %>% as.numeric()
slopes[i,6] <- lm_j$coefficients[2] %>% as.numeric()
}
### COST OF TRANSPORT ###
swim <- data.frame(Species=c("Pegea confoederata","Iasis (Weelia) cylindrica","Cyclosalpa affinis"),Speed.cm.s=c(1.68,1.23,1.72))
COT <- left_join(slopes, swim, by="Species")
COT$Zooid.length..mm. <- as.numeric(COT$Zooid.length..mm.)
COT$Number.of.zooids <- as.numeric(COT$Number.of.zooids)
COT %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10) -> COT
COT
RelSpecific
series_i
min(series_i$Time.point..min.)
max(series_i$Time.point..min.)-min(series_i$Time.point..min.)
slopes <- as.data.frame(matrix(ncol=7,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Zooid.length..mm.","Number.of.zooids","Slope_O2","Slope_CorrO2sat","Timespan")
for(i in 1:length(unique(norm_presens$Specimen))){
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Number.of.zooids","Time.point..min.","O2..mg.L.specific","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~O2..mg.L.specific, series_i)
lm_j <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients);print(lm_j$coefficients)
time.span_i <- max(series_i$Time.point..min.)-min(series_i$Time.point..min.)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- series_i$Zooid.length..mm.[1] %>% as.character()
slopes[i,4] <- series_i$Number.of.zooids[1] %>% as.character()
slopes[i,5] <- lm_i$coefficients[2] %>% as.numeric()
slopes[i,6] <- lm_j$coefficients[2] %>% as.numeric()
slopes[i,7] <- time.span_i
}
swim <- data.frame(Species=c("Pegea confoederata","Iasis (Weelia) cylindrica","Cyclosalpa affinis"),Speed.cm.s=c(1.68,1.23,1.72))
COT <- left_join(slopes, swim, by="Species")
COT$Zooid.length..mm. <- as.numeric(COT$Zooid.length..mm.)
COT$Number.of.zooids <- as.numeric(COT$Number.of.zooids)
COT %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10) -> COT
COT
225/1000
#Define COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
COT %>% mutate(COT, mgO2 = abs(Slope_O2)*0.225*Timespan)
#Define COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
COT %>% mutate(mgO2 = abs(Slope_O2)*0.225*Timespan)
series_i
lm_i
#Define COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
COT %>% mutate(mgO2 = abs(Slope_O2)*0.225/Timespan)
#Define COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
COT %>% mutate(COT.abs = abs(Slope_O2)*0.225*Speed.cm.s*60, COT.rel = abs(Slope_O2)*0.225*Speed.body.s*60)
ggplot(COT,aes(x=Species,y=COT.abs))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
COT
#Define COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
COT %>% mutate(COT.abs = abs(Slope_O2)*0.225*Speed.cm.s*60, COT.rel = abs(Slope_O2)*0.225*Speed.body.s*60)
ggplot(COT,aes(x=Species,y=COT.abs))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
#Define COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
COT %>% mutate(COT.abs = abs(Slope_O2)*0.225*Speed.cm.s*60, COT.rel = abs(Slope_O2)*0.225*Speed.body.s*60)->COT
ggplot(COT,aes(x=Species,y=COT.abs))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(COT,aes(x=Species,y=COT.rel))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(slopes,aes(x=Species,y=Slope_O2sat))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(slopes,aes(x=Species,y=Slope_O2))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
names(norm_presens)
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Number.of.zooids","Time.point..min.","Temperature...C.","sat_O2.specific","corr_sat_O2.specific")]
series_i$Temperature...C.
slopes <- as.data.frame(matrix(ncol=8,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Zooid.length..mm.","Number.of.zooids","Slope_O2","Slope_CorrO2sat","Timespan","Temperature...C.")
for(i in 1:length(unique(norm_presens$Specimen))){
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Number.of.zooids","Time.point..min.","Temperature...C.","sat_O2.specific","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~O2..mg.L.specific, series_i)
lm_j <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients);print(lm_j$coefficients)
time.span_i <- max(series_i$Time.point..min.)-min(series_i$Time.point..min.)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- series_i$Zooid.length..mm.[1] %>% as.character()
slopes[i,4] <- series_i$Number.of.zooids[1] %>% as.character()
slopes[i,5] <- lm_i$coefficients[2] %>% as.numeric()
slopes[i,6] <- lm_j$coefficients[2] %>% as.numeric()
slopes[i,7] <- time.span_i
slopes[i,8] <- series_i$Temperature...C. %>% mean()
}
slopes <- as.data.frame(matrix(ncol=8,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Zooid.length..mm.","Number.of.zooids","Slope_O2","Slope_CorrO2sat","Timespan","Temperature...C.")
for(i in 1:length(unique(norm_presens$Specimen))){
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Number.of.zooids","Time.point..min.","Temperature...C.","sat_O2.specific","corr_sat_O2.specific")]
lm_i <- lm(Time.point..min.~sat_O2.specific, series_i)
lm_j <- lm(Time.point..min.~corr_sat_O2.specific, series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients);print(lm_j$coefficients)
time.span_i <- max(series_i$Time.point..min.)-min(series_i$Time.point..min.)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- series_i$Zooid.length..mm.[1] %>% as.character()
slopes[i,4] <- series_i$Number.of.zooids[1] %>% as.character()
slopes[i,5] <- lm_i$coefficients[2] %>% as.numeric()
slopes[i,6] <- lm_j$coefficients[2] %>% as.numeric()
slopes[i,7] <- time.span_i
slopes[i,8] <- series_i$Temperature...C. %>% mean()
}
slopes
swim <- data.frame(Species=c("Pegea confoederata","Iasis (Weelia) cylindrica","Cyclosalpa affinis"),Speed.cm.s=c(1.68,1.23,1.72))
COT <- left_join(slopes, swim, by="Species")
COT$Zooid.length..mm. <- as.numeric(COT$Zooid.length..mm.)
COT$Number.of.zooids <- as.numeric(COT$Number.of.zooids)
COT %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10) -> COT
COT
COT <- left_join(slopes, swim, by="Species")
COT$Zooid.length..mm. <- as.numeric(COT$Zooid.length..mm.)
COT$Number.of.zooids <- as.numeric(COT$Number.of.zooids)
COT %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10) -> COT
COT %>% mutate(absO2slope = abs(Slope_O2)*0.225*oxySol(Temperature...C., 30.1, 1)) -> COT
COT
#Define COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
COT %>% mutate(COT.abs = absO2slope*Speed.cm.s*60, COT.rel = abs(Slope_O2)*0.225*Speed.body.s*60)->COT
COT
ggplot(COT,aes(x=Species,y=COT.abs))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(COT,aes(x=Species,y=COT.rel))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
COT <- left_join(slopes, swim, by="Species")
COT$Zooid.length..mm. <- as.numeric(COT$Zooid.length..mm.)
COT$Number.of.zooids <- as.numeric(COT$Number.of.zooids)
COT %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10) -> COT
COT %>% mutate(absO2slope = abs(Slope_O2)*0.225*oxySol(Temperature...C., 30.1, 1)) -> COT
#Define COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
COT %>% mutate(COT.abs = absO2slope*Speed.cm.s*60/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids), COT.rel = abs(Slope_O2)*0.225*Speed.body.s*60/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids))->COT
ggplot(COT,aes(x=Species,y=COT.abs))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(COT,aes(x=Species,y=COT.rel))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
COT$Species <- factor(as.character(COT$Species), levels = unique(as.character(COT$Species)))
ggplot(COT,aes(x=Species,y=COT.abs))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
as.character(COT$Species)
COT <- COT[which(!is.na(COT$COT.abs)),]
ggplot(COT,aes(x=Species,y=COT.abs))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(slopes,aes(x=Species,y=Slope_O2))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
norm_presens["Pegea confoederata",]
norm_presens[Species=="Pegea confoederata",]
norm_presens[norm_presensSpecies=="Pegea confoederata",]
norm_presens[norm_presens$Species=="Pegea confoederata",]
rawSatSpecific
slopes
View(slopes)
RelSpecific
slopes <- as.data.frame(matrix(ncol=8,nrow=length(unique(norm_presens$Specimen))))
names(slopes) <- c("Species","Specimen","Zooid.length..mm.","Number.of.zooids","Slope_O2","Slope_CorrO2sat","Timespan","Temperature...C.")
for(i in 1:length(unique(norm_presens$Specimen))){
spm_i <- unique(norm_presens$Specimen)[i]
series_i <- norm_presens[which(norm_presens$Specimen==spm_i),c("Specimen","Species","Zooid.length..mm.","Number.of.zooids","Time.point..min.","Temperature...C.","sat_O2.specific","corr_sat_O2.specific")]
lm_i <- lm(sat_O2.specific~Time.point..min., series_i)
lm_j <- lm(corr_sat_O2.specific~Time.point..min., series_i)
print(series_i$Specimen[1] %>% as.character());print(series_i$Species[1] %>% as.character());print(lm_i$coefficients);print(lm_j$coefficients)
time.span_i <- max(series_i$Time.point..min.)-min(series_i$Time.point..min.)
slopes[i,1] <- series_i$Species[1] %>% as.character()
slopes[i,2] <- series_i$Specimen[1] %>% as.character()
slopes[i,3] <- series_i$Zooid.length..mm.[1] %>% as.character()
slopes[i,4] <- series_i$Number.of.zooids[1] %>% as.character()
slopes[i,5] <- lm_i$coefficients[2] %>% as.numeric()
slopes[i,6] <- lm_j$coefficients[2] %>% as.numeric()
slopes[i,7] <- time.span_i
slopes[i,8] <- series_i$Temperature...C. %>% mean()
}
ggplot(slopes,aes(x=Species,y=Slope_O2))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(slopes,aes(x=Species,y=Slope_CorrO2sat))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(slopes,aes(x=Species,y=-Slope_O2))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(slopes,aes(x=Species,y=-Slope_CorrO2sat))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
swim <- data.frame(Species=c("Pegea confoederata","Iasis (Weelia) cylindrica","Cyclosalpa affinis"),Speed.cm.s=c(1.68,1.23,1.72))
COT <- left_join(slopes, swim, by="Species")
COT$Zooid.length..mm. <- as.numeric(COT$Zooid.length..mm.)
COT$Number.of.zooids <- as.numeric(COT$Number.of.zooids)
COT %>% mutate(Speed.body.s = Zooid.length..mm.*Speed.cm.s/10) -> COT
COT %>% mutate(absO2slope = abs(Slope_O2)*0.225*oxySol(Temperature...C., 30.1, 1)) -> COT
#Define COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
COT %>% mutate(COT.abs = absO2slope*Speed.cm.s*60/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids), COT.rel = abs(Slope_O2)*0.225*Speed.body.s*60/((((Zooid.length..mm./2)^2)*Zooid.length..mm.)*Number.of.zooids))->COT
COT <- COT[which(!is.na(COT$COT.abs)),]
ggplot(COT,aes(x=Species,y=COT.abs))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
ggplot(COT,aes(x=Species,y=COT.rel))+geom_boxplot()+theme(axis.text.x = element_text(angle = 90))
