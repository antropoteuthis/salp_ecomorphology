geom_jitter(aes(color=Architecture),alpha=0.9)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
ggplot(COT_with_means %>%
filter(COT.abs.ml>-10000000 & Architecture != "Whorl chain"),
aes(Architecture,
y=COT.abs.ml, fill=Architecture)) +
geom_jitter(aes(color=Architecture),alpha=0.7)+
stat_summary(fun = "mean", geom = "bar", position = "dodge", alpha=0.5) +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust=1))+
ylab("Cost of Transport (pgO2/ml per zooid length moved)")+
xlab("Architecture")
null_model <- lmer(COT.abs.ml ~ 1 + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))), REML = FALSE)
anova(null_model, mixed_model)
mixed_model <- lmer(COT.abs.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
#specimen and species model are on par, species model chosen for simplicity
lmer(COT.abs.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>%
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary()
#specimen and species model are on par, species model chosen for simplicity
lmer(COT.abs.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary()
fixed_model <- lm(COT.rel.ml ~ Architecture, data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
specimen_model <- lmer(COT.rel.ml ~ Architecture + (1 | Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
species_model <- lmer(COT.rel.ml ~ Architecture + (1 | Species), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
mixed_model <- lmer(COT.rel.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
#specimen and species model are on par, species model chosen for simplicity
lmer(COT.abs.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary()
null_model <- lmer(COT.rel.ml ~ 1 + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))), REML = FALSE)
anova(null_model, mixed_model)
#Species model wins
lmer(COT.rel.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary()
null_model <- lmer(COT.rel.ml ~ 1 + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))), REML = FALSE)
anova(null_model, mixed_model)
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary()
fixed_model <- lm(Speed_mms_abs ~ Pulses_per_second, data = speed_annotated)
mixed_model <- lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated)
species_model <- lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species), data = speed_annotated)
specimen_model <- lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Filename), data = speed_annotated)
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(BLperSecond ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated) %>% summary()
lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated) %>% summary()
fixed_model <- lm(Speed_mms_abs ~ Pulses_per_second, data = speed_annotated)
mixed_model <- lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated)
species_model <- lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species), data = speed_annotated)
specimen_model <- lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Filename), data = speed_annotated)
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated) %>% summary()
lmer(BLperSecond ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated) %>% summary()
fixed_model <- lm(BLperSecond ~ Pulses_per_second, data = speed_annotated)
mixed_model <- lmer(BLperSecond ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated)
species_model <- lmer(BLperSecond ~ Pulses_per_second + (1 | Species), data = speed_annotated)
specimen_model <- lmer(BLperSecond ~ Pulses_per_second + (1 | Filename), data = speed_annotated)
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(BLperSecond ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated) %>% summary()
fixed_model <- lm(Speed_mms_abs ~ Zooid_length_mm, data = speed_annotated)
mixed_model <- lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated)
species_model <- lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Species), data = speed_annotated)
specimen_model <- lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Filename), data = speed_annotated)
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated) %>% summary()
lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Filename/Species), data = speed_annotated) %>% summary()
lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated) %>% summary()
fixed_model <- lm(Speed_mms_abs/Pulses_per_second ~ Zooid_length_mm, data = speed_annotated)
mixed_model <- lmer(Speed_mms_abs/Pulses_per_second ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated)
species_model <- lmer(Speed_mms_abs/Pulses_per_second ~ Zooid_length_mm + (1 | Species), data = speed_annotated)
specimen_model <- lmer(Speed_mms_abs/Pulses_per_second ~ Zooid_length_mm + (1 | Filename), data = speed_annotated)
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(Speed_mms_abs/Pulses_per_second ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated) %>% summary()
fixed_model <- lm(Speed_mms_abs ~ Zooid.number, data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical"))))
mixed_model <- lmer(Speed_mms_abs ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical"))))
species_model <- lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical"))))
specimen_model <- lmer(Speed_mms_abs ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical"))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
fixed_model <- lm(BLperPulse ~ Zooid.number, data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical"))))
mixed_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical"))))
species_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical"))))
specimen_model <- lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical"))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
fixed_model <- glm(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode, data=speed_groupedArch)
speed_annotated %>%
filter(!is.na(Species) & Architecture != "Whorl chain") %>% mutate(CSAmode = case_when(
Architecture %in% c("Transversal", "Cluster", "Whorl", "Oblique") ~ "CSA_Scaling",
Architecture %in% c("Linear", "Bipinnate","Helical") ~ "CSA_Constant",
TRUE ~ as.character(Architecture)
)) -> speed_groupedArch
fixed_model <- glm(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode, data=speed_groupedArch)
mixed_model <- lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch)
species_model <- lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species), data = speed_groupedArch)
specimen_model <- lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Filename), data = speed_groupedArch)
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>% summary()
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>% compute_deviance()
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>% deviance()
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>% anova()
fixed_model <- lm(BLperPulse ~ Zooid.number, data = speed_annotated %>% filter(Architecture=="Whorl"))
mixed_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter(Architecture=="Whorl"))
species_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(Architecture=="Whorl"))
specimen_model <- lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Whorl"))
AIC(fixed_model, mixed_model, species_model, specimen_model)
fixed_model <- lm(BLperPulse ~ Zooid.number, data = speed_annotated %>% filter(Architecture=="Cluster"))
mixed_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter(Architecture=="Cluster"))
species_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(Architecture=="Cluster"))
specimen_model <- lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Cluster"))
AIC(fixed_model, mixed_model, species_model, specimen_model)
fixed_model <- lm(BLperPulse ~ Zooid.number, data = speed_annotated %>% filter(Architecture=="Transversal"))
mixed_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter(Architecture=="Transversal"))
species_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(Architecture=="Transversal"))
specimen_model <- lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Transversal"))
AIC(fixed_model, mixed_model, species_model, specimen_model)
fixed_model <- lm(BLperPulse ~ Zooid.number, data = speed_annotated %>% filter(Architecture=="Linear"))
mixed_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter(Architecture=="Linear"))
species_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(Architecture=="Linear"))
specimen_model <- lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Linear"))
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(Architecture=="Linear")) %>% summary()
fixed_model <- lm(BLperPulse ~ Zooid.number, data = speed_annotated %>% filter(Architecture=="Bipinnate"))
mixed_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter(Architecture=="Bipinnate"))
species_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(Architecture=="Bipinnate"))
specimen_model <- lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Bipinnate"))
AIC(fixed_model, mixed_model, species_model, specimen_model)
dvsz <- read.csv("~/salp_ecomorphology/DV_Zooid.stolon.angle.tsv",sep='\t', stringsAsFactors = F)[,c(5,8,7,10)]
names(dvsz)[4] <- "Dorsoventral_Zooid_Stolon_Angle"
dvsz$Species[which(dvsz$Species == "Thalia longicauda" | dvsz$Species == "Thalia cicar")] <- "Thalia sp."
meanDVZS <- dvsz[,-3] %>%
group_by(Species, Architecture) %>%
summarise(across(where(is.numeric), mean, na.rm = TRUE)) %>% as.data.frame() #Get the mean DVZS angle for each species, since the specimens dont match
speed_dvzs <- full_join(speed_annotated, meanDVZS, by = c("Species","Architecture")) %>% filter(Architecture!= "Whorl chain") #join with the speeds
lm(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle , data = speed_dvzs) %>% summary()
fixed_model <- lm(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle, data = speed_dvzs)
mixed_model <- lmer(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs)
species_model <- lmer(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species), data = speed_dvzs)
specimen_model <- lmer(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Filename), data = speed_dvzs)
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% summary()
fixed_model <- lm(BLperPulse ~ Dorsoventral_Zooid_Stolon_Angle, data = speed_dvzs)
mixed_model <- lmer(BLperPulse ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs)
species_model <- lmer(BLperPulse ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species), data = speed_dvzs)
specimen_model <- lmer(BLperPulse ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Filename), data = speed_dvzs)
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(BLperPulse ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% summary()
fixed_model <- lm(log(COT.abs.ml) ~ Speed_mm_s, data=COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain"))
mixed_model <- lmer(log(COT.abs.ml) ~ Speed_mm_s + (1 | Species/Specimen), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain"))
species_model <- lmer(log(COT.abs.ml) ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain"))
specimen_model <- lmer(log(COT.abs.ml) ~ Speed_mm_s + (1 | Specimen), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain"))
AIC(fixed_model, mixed_model, species_model, specimen_model)
fixed_model <- lm(log(COT.rel.ml) ~ BLperSecond, data=COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain"))
mixed_model <- lmer(log(COT.rel.ml) ~ BLperSecond + (1 | Species/Specimen), data = COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain"))
species_model <- lmer(log(COT.rel.ml) ~ BLperSecond + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain"))
specimen_model <- lmer(log(COT.rel.ml) ~ BLperSecond + (1 | Specimen), data = COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain"))
AIC(fixed_model, mixed_model, species_model, specimen_model)
lm(log(COT.rel.ml) ~ BLperSecond, data=COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain")) %>% summary()
fixed_model <- lm(COT.abs.ml ~ Speed_mm_s, data=COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain"))
mixed_model <- lmer(COT.abs.ml ~ Speed_mm_s + (1 | Species/Specimen), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain"))
species_model <- lmer(COT.abs.ml ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain"))
specimen_model <- lmer(COT.abs.ml ~ Speed_mm_s + (1 | Specimen), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain"))
AIC(fixed_model, mixed_model, species_model, specimen_model)
fixed_model <- lm(COT.rel.ml ~ BLperSecond, data=COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain"))
mixed_model <- lmer(COT.rel.ml ~ BLperSecond + (1 | Species/Specimen), data = COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain"))
species_model <- lmer(COT.rel.ml ~ BLperSecond + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain"))
specimen_model <- lmer(COT.rel.ml ~ BLperSecond + (1 | Specimen), data = COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain"))
AIC(fixed_model, mixed_model, species_model, specimen_model)
lm(COT.p.ml ~ Pulses_per_second,
data = COT_with_means %>%
filter(COT.p.ml>0 & !is.na(Species) & Architecture != "Whorl chain"),
family = gaussian(link = "identity")) %>% summary()
lm(COT.p.ml ~ COT.abs.ml, data = COT_with_means %>%
filter(!is.na(COT.p.ml) & !is.na(Species)),
family = gaussian(link = "identity")) %>% summary()
lm(COT.p.ml ~ COT.abs.ml, data = COT_with_means %>%
filter(!is.na(COT.p.ml) & !is.na(Species))) %>% summary()
fixed_model <- lm(COT.p.ml ~ COT.abs.ml, data=COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species)))
mixed_model <- lmer(COT.p.ml ~ COT.abs.ml + (1 | Species/Specimen), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species)))
species_model <- lmer(COT.p.ml ~ COT.abs.ml + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species)))
specimen_model <- lmer(COT.p.ml ~ COT.abs.ml + (1 | Specimen), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species)))
AIC(fixed_model, mixed_model, species_model, specimen_model)
fixed_model <- lm(COT.p.ml ~ COT.rel.ml, data=COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species)))
mixed_model <- lmer(COT.p.ml ~ COT.rel.ml + (1 | Species/Specimen), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species)))
species_model <- lmer(COT.p.ml ~ COT.rel.ml + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species)))
specimen_model <- lmer(COT.p.ml ~ COT.rel.ml + (1 | Specimen), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species)))
AIC(fixed_model, mixed_model, species_model, specimen_model)
library(performance)
library(performance)
r2(lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated))
r2(lmer(BLperSecond ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated))
r2(lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated))
r2(lmer(Speed_mms_abs/Pulses_per_second ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated))
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>% r2()
library(partr2)
install.packages("partR2")
library(partr2)
library(partR2)
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>%
partR2(partvars = c("Zooid_length_mm", "Pulses_per_second", "Zooid.number", "CSAmode"), R2_type = "marginal")
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Whorl")) %>% r2()
lm(BLperPulse ~ Zooid.number, data=speed_annotated %>% filter(Architecture=="Transversal")) %>% r2()
lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(Architecture=="Linear")) %>% r2()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Bipinnate")) %>% r2()
lmer(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% r2()
lmer(BLperPulse ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% r2()
lmer(log(COT.abs.ml) ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain")) %>% r2()
lm(log(COT.rel.ml) ~ BLperSecond, data=COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain")) %>% r2()
lmer(COT.abs.ml ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain")) %>% r2()
lmer(COT.rel.ml ~ BLperSecond + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain")) %>% r2()
COT_with_means %>% filter(!is.na(COT.p.ml) & Species != "Brooksia rostrata" & Architecture != "Whorl chain") %>%
.[,c("Species","COT.p.ml")] %>% group_by(Species) %>%
summarise(mean(COT.p.ml))
lmer(COT.p.ml ~ COT.abs.ml + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% r2()
lmer(COT.p.ml ~ COT.rel.ml + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% r2()
lmer(COT.p.ml ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% r2()
lmer(COT.p.ml ~ BLperSecond + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% r2()
COT_with_means %>% filter(-Slope_O2_dif_normalized/1000000 < 0.0025) %>%
group_by(Species) %>%
summarise(meanCOTp = mean(COT.p.ml, na.rm=T)) %>% as.data.frame()
COT_with_means %>% filter(-Slope_O2_dif_normalized/1000000 < 0.0025) %>%
group_by(Architecture) %>%
summarise(meanCOTabs = mean(COT.abs.ml, na.rm=T)) %>% as.data.frame()
speed_annotated$Architecture
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary()
mixed_model <- lmer(Speed_mm_s ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
#mixed model wins
lmer(Speed_mm_s ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA)))) %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% class()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% .[[1]]
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% .[[2]]
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% str()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% .[,c("contrast","estimate","p.value")]
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% .[,c("contrast","estimate","p.value")]
fixed_model <- lm(BLperPulse ~ Architecture, data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
specimen_model <- lmer(BLperPulse ~ Architecture + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
species_model <- lmer(BLperPulse ~ Architecture + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
mixed_model <- lmer(BLperPulse ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
#mixed model wins
lmer(BLperPulse ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA)))) %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% .[,c("contrast","estimate","p.value")]
fixed_model <- lm(COT.abs.ml ~ Architecture, data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
specimen_model <- lmer(COT.abs.ml ~ Architecture + (1 | Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
species_model <- lmer(COT.abs.ml ~ Architecture + (1 | Species), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
mixed_model <- lmer(COT.abs.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
#specimen and species model are on par, species model chosen for simplicity
lmer(COT.abs.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% .[,c("contrast","estimate","p.value")]
mixed_model <- lmer(COT.rel.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary()  %>% .[,c("contrast","estimate","p.value")]
mixed_model <- lmer(COT.abs.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% .[,c("contrast","estimate","p.value")]
r2(lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated))
lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated) %>% summary()
lmer(BLperSecond ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated) %>% summary()
r2(lmer(BLperSecond ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated))
lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated) %>% summary()
lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated) %>% summary()
r2(lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated))
lmer(Speed_mms_abs/Pulses_per_second ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated) %>% summary()
r2(lmer(Speed_mms_abs/Pulses_per_second ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated))
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lm(Speed_mms_abs ~ Zooid.number, data=speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
speed_annotated %>%
filter(!is.na(Species) & Architecture != "Whorl chain" & !is.na(BLperPulse)) %>% mutate(CSAmode = case_when(
Architecture %in% c("Transversal", "Cluster", "Whorl", "Oblique") ~ "Scaling Frontal Area",
Architecture %in% c("Linear", "Bipinnate", "Helical") ~ "Constant Frontal Area",
TRUE ~ as.character(Architecture)
)) %>%
group_by(CSAmode) %>%
ggplot(aes(Zooid.number, BLperPulse)) +
geom_point(alpha=0.5,aes(color=Architecture))+
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
geom_smooth(col = "black", method = 'lm', se = TRUE) +  # Add regression line
theme_bw() +
ylab("Speed (zooids/pulse)")+
xlab("Number of zooids")+
facet_wrap(~CSAmode, scales = "free_x")
fixed_model <- lm(Speed_mms_abs ~ Zooid.number, data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical"))))
mixed_model <- lmer(Speed_mms_abs ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical"))))
species_model <- lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical"))))
specimen_model <- lmer(Speed_mms_abs ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical"))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
#LMER Speed ~ Zooid number vs Constant species
lm(Speed_mms_abs ~ Zooid.number, data=speed_annotated %>% filter(Architecture %in% c("Linear","Bipinnate", "Helical"))) %>% summary()
lm(Speed_mms_abs ~ Zooid.number, data=speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lm(BLperPulse ~ Zooid.number, data=speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
fixed_model <- lm(BLperPulse ~ Zooid.number, data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical"))))
mixed_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical"))))
species_model <- lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical"))))
specimen_model <- lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical"))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>% summary()
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>% r2()
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>%
partR2(partvars = c("Zooid_length_mm", "Pulses_per_second", "Zooid.number", "CSAmode"), R2_type = "marginal")
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>%
partR2(partvars = c("Zooid_length_mm", "Pulses_per_second", "Zooid.number", "CSAmode"), R2_type = "conditional")
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>%
partR2(partvars = c("Zooid_length_mm", "Pulses_per_second", "Zooid.number", "CSAmode"))
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Whorl")) %>% r2()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Whorl")) %>% summary()
r2(lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated))
r2(lmer(BLperSecond ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated))
r2(lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated))
r2(lmer(Speed_mms_abs/Pulses_per_second ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated))
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% r2()
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>%
partR2(partvars = c("Zooid_length_mm", "Pulses_per_second", "Zooid.number", "CSAmode"), R2_type = "marginal")
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Cluster")) %>% r2()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Cluster")) %>% summary()
lm(BLperPulse ~ Zooid.number, data=speed_annotated %>% filter(Architecture=="Transversal")) %>% r2()
lm(BLperPulse ~ Zooid.number, data=speed_annotated %>% filter(Architecture=="Transversal")) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(Architecture=="Linear")) %>% r2()
lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(Architecture=="Linear")) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Bipinnate")) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Bipinnate")) %>% r2()
lmer(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% summary()
lmer(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% r2()
lmer(BLperPulse ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% summary()
lmer(BLperPulse ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% r2()
lmer(log(COT.abs.ml) ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain")) %>% summary()
lmer(log(COT.abs.ml) ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain")) %>% r2()
lm(log(COT.rel.ml) ~ BLperSecond, data=COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain")) %>% summary()
lm(log(COT.rel.ml) ~ BLperSecond, data=COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain")) %>% r2()
lmer(COT.abs.ml ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain")) %>% summary()
lmer(COT.abs.ml ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain")) %>% r2()
lmer(COT.rel.ml ~ BLperSecond + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain")) %>% summary()
lmer(COT.rel.ml ~ BLperSecond + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain")) %>% r2()
lmer(COT.p.ml ~ COT.abs.ml + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% summary()
lmer(COT.p.ml ~ COT.abs.ml + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% r2()
lmer(COT.p.ml ~ COT.rel.ml + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% summary()
lmer(COT.p.ml ~ COT.rel.ml + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% r2()
lmer(COT.p.ml ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% summary()
lmer(COT.p.ml ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% r2()
lmer(COT.p.ml ~ BLperSecond + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% summary()
lmer(COT.p.ml ~ BLperSecond + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% r2()
#mixed model wins
lmer(Speed_mm_s ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA)))) %>% summary()
#mixed model wins
lmer(Speed_mm_s ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA)))) %>% r2()
fixed_model <- lm(Speed_mm_s ~ Architecture, data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
specimen_model <- lmer(Speed_mm_s ~ Architecture + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
species_model <- lmer(Speed_mm_s ~ Architecture + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
mixed_model <- lmer(Speed_mm_s ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
#mixed model wins
lmer(Speed_mm_s ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA)))) %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% .[,c("contrast","estimate","p.value")]
null_model <- lmer(Speed_mm_s ~ 1 + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))), REML = FALSE)
anova(null_model, mixed_model)
fixed_model <- lm(BLperPulse ~ Architecture, data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
specimen_model <- lmer(BLperPulse ~ Architecture + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
species_model <- lmer(BLperPulse ~ Architecture + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
mixed_model <- lmer(BLperPulse ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
#mixed model wins
lmer(BLperPulse ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA)))) %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% .[,c("contrast","estimate","p.value")]
null_model <- lmer(BLperPulse ~ 1 + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA))), REML = FALSE)
anova(null_model, mixed_model)
lmer(BLperPulse ~ Architecture + (1 | Species/Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Whorl chain", "Helical", "Oblique", NA)))) %>% r2()
fixed_model <- lm(COT.abs.ml ~ Architecture, data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
specimen_model <- lmer(COT.abs.ml ~ Architecture + (1 | Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
species_model <- lmer(COT.abs.ml ~ Architecture + (1 | Species), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
mixed_model <- lmer(COT.abs.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
#specimen and species model are on par, species model chosen for simplicity
lmer(COT.abs.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary() %>% .[,c("contrast","estimate","p.value")]
null_model <- lmer(COT.abs.ml ~ 1 + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))), REML = FALSE)
anova(null_model, mixed_model)
lmer(COT.abs.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>% r2()
lmer(COT.abs.ml ~ Architecture + (1 | Species), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>% r2()
lmer(COT.abs.ml ~ Architecture + (1 | Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>% r2()
fixed_model <- lm(COT.rel.ml ~ Architecture, data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
specimen_model <- lmer(COT.rel.ml ~ Architecture + (1 | Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
species_model <- lmer(COT.rel.ml ~ Architecture + (1 | Species), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
mixed_model <- lmer(COT.rel.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))))
AIC(fixed_model, mixed_model, species_model, specimen_model)
#Species model wins
lmer(COT.rel.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>% summary()
emmeans(mixed_model, "Architecture") %>% contrast(method = "pairwise", adjust = "tukey") %>% summary()  %>% .[,c("contrast","estimate","p.value")]
null_model <- lmer(COT.rel.ml ~ 1 + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA))), REML = FALSE)
anova(null_model, mixed_model)
lmer(COT.rel.ml ~ Architecture + (1 | Species/Specimen), data = COT_with_means %>% filter(!(Architecture %in% c("Whorl chain", "Helical", NA)))) %>% r2()
lmer(Speed_mms_abs ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated) %>% summary()
lmer(BLperSecond ~ Pulses_per_second + (1 | Species/Filename), data = speed_annotated) %>% summary()
lmer(Speed_mms_abs ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated) %>% summary()
lmer(Speed_mms_abs/Pulses_per_second ~ Zooid_length_mm + (1 | Species/Filename), data = speed_annotated) %>% summary()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Species/Filename), data = speed_annotated %>% filter((Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(Speed_mms_abs ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(!(Architecture %in% c("Linear","Bipinnate", "Helical")))) %>% summary()
lmer(Speed_mms_abs ~ Zooid_length_mm + Pulses_per_second + Zooid.number + CSAmode + (1 | Species/Filename), data = speed_groupedArch) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Whorl")) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Cluster")) %>% summary()
lm(BLperPulse ~ Zooid.number, data=speed_annotated %>% filter(Architecture=="Transversal")) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Species), data = speed_annotated %>% filter(Architecture=="Linear")) %>% summary()
lmer(BLperPulse ~ Zooid.number + (1 | Filename), data = speed_annotated %>% filter(Architecture=="Bipinnate")) %>% summary()
lmer(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% summary()
lmer(Speed_mms_abs ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% summary()
lmer(BLperPulse ~ Dorsoventral_Zooid_Stolon_Angle + (1 | Species/Filename), data = speed_dvzs) %>% summary()
lmer(log(COT.abs.ml) ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain")) %>% summary()
lm(log(COT.rel.ml) ~ BLperSecond, data=COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain")) %>% summary()
lmer(COT.abs.ml ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.abs.ml) & Architecture != "Whorl chain")) %>% summary()
lmer(COT.rel.ml ~ BLperSecond + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.rel.ml) & Architecture != "Whorl chain")) %>% summary()
lmer(COT.p.ml ~ COT.abs.ml + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% summary()
lmer(COT.p.ml ~ COT.rel.ml + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% summary()
lmer(COT.p.ml ~ Speed_mm_s + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% summary()
lmer(COT.p.ml ~ BLperSecond + (1 | Species), data = COT_with_means %>% filter(!is.na(COT.p.ml) & !is.na(Species))) %>% summary()
presens %>%
group_by(Experiment) %>%
arrange(Time.point..min.) %>%  # Ensure rows are ordered by time within each experiment
summarise(
Avg_Spacing = mean(diff(Time.point..min.), na.rm = TRUE)
)
presens %>%
group_by(Experiment) %>%
arrange(Time.point..min.) %>%  # Ensure rows are ordered by time within each experiment
summarise(
Avg_Spacing = mean(diff(Time.point..min.), na.rm = TRUE)
) %>% as.data.frame()
presens %>%
group_by(Experiment) %>%
arrange(Time.point..min.) %>%  # Ensure rows are ordered by time within each experiment
summarise(
Avg_Spacing = mean(diff(Time.point..min.), na.rm = TRUE)
) %>% as.data.frame() %>% plot()
presens %>%
group_by(Experiment) %>%
arrange(Time.point..min.) %>%  # Ensure rows are ordered by time within each experiment
summarise(
Avg_Spacing = mean(diff(Time.point..min.), na.rm = TRUE)
) %>% as.data.frame() %>% mean()
presens %>%
group_by(Experiment) %>%
arrange(Time.point..min.) %>%  # Ensure rows are ordered by time within each experiment
summarise(
Avg_Spacing = mean(diff(Time.point..min.), na.rm = TRUE)
) %>% as.data.frame() %>% mean(.$Avg_Spacing)
presens %>%
group_by(Experiment) %>%
arrange(Time.point..min.) %>%  # Ensure rows are ordered by time within each experiment
summarise(
Avg_Spacing = mean(diff(Time.point..min.), na.rm = TRUE)
) %>% as.data.frame() %>% .[,2]
presens %>%
group_by(Experiment) %>%
arrange(Time.point..min.) %>%  # Ensure rows are ordered by time within each experiment
summarise(
Avg_Spacing = mean(diff(Time.point..min.), na.rm = TRUE)
) %>% as.data.frame() %>% .[,2] %>% mean()
presens %>%
group_by(Experiment) %>%
arrange(Time.point..min.) %>%  # Ensure rows are ordered by time within each experiment
summarise(
Avg_Spacing = mean(diff(Time.point..min.), na.rm = TRUE)
) %>% as.data.frame() %>% .[,2] %>% sd()
presens %>%
group_by(Experiment) %>%
arrange(Time.point..min.) %>%  # Ensure rows are ordered by time within each experiment
summarise(
Avg_Spacing = mean(diff(Time.point..min.), na.rm = TRUE)
) %>% as.data.frame() %>% .[,2] %>% min()
presens %>%
group_by(Experiment) %>%
arrange(Time.point..min.) %>%  # Ensure rows are ordered by time within each experiment
summarise(
Avg_Spacing = mean(diff(Time.point..min.), na.rm = TRUE)
) %>% as.data.frame() %>% .[,2] %>% median()
