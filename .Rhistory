ylab("Gross respiration rate (pgO2/min)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))#+
warnings()
slopes %>% filter(Treatment=="Intact") %>%
ggplot(aes(x=Species,y=-Slope_O2))
slopes %>% filter(Treatment=="Intact") %>%
ggplot(aes(x=Species,y=-Slope_O2))->slope_plot
slope_plot+
geom_violin(color="red",fill="red", alpha=0.7)+
geom_point(color="red",fill="red", alpha=0.7)+
geom_violin(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue", fill="blue", alpha=0.7, width = 0.5)+
geom_point(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue",fill="red", alpha=0.7)+
ylab("Gross respiration rate (pgO2/min)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))#+
slope_plot+
geom_violin(color="red",fill="red", alpha=0.7)+
geom_point(color="red",fill="red", alpha=0.7)
slopes %>% filter(Treatment=="Intact") %>%
ggplot(aes(x=Species,y=-Slope_O2))->slope_plot
slope_plot+
geom_violin(color="red",fill="red", alpha=0.7)+
geom_point(color="red",fill="red", alpha=0.7)+
geom_violin(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue", fill="blue", alpha=0.7, width = 0.5)+
geom_point(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue",fill="red", alpha=0.7)+
ylab("Gross respiration rate (pgO2/min)")
slopes %>% filter(Treatment=="Anesthetized")
slopes %>% filter(Treatment=="Anesthetized") %>% .$Species
slopes %>% filter(Treatment=="Anesthetized") %>% .$Species %>% unique()
slopes %>% filter(Treatment=="Intact") %>%
ggplot(aes(x=Species,y=-Slope_O2_dif))+
geom_violin(color="red",fill="red", alpha=0.7)+
geom_point(color="red",fill="red", alpha=0.7)+
geom_violin(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue", fill="blue", alpha=0.7, width = 0.5)+
geom_point(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue",fill="red", alpha=0.7)+
ylab("Net respiration rate (mgO2/min)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))#+
slopes %>% filter(Treatment=="Intact") %>%
ggplot(aes(x=Species,y=-Slope_normalized))+
geom_violin(color="red",fill="red", alpha=0.7)+
geom_point(color="red",fill="red", alpha=0.7)+
geom_violin(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue", fill="blue", alpha=0.7, width = 0.5)+
geom_point(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue",fill="red", alpha=0.7)+
ylab("Raw respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
slopes %>% filter(Treatment=="Intact") %>%
ggplot(aes(x=Species,y=-Slope_O2_dif_normalized))+
geom_violin(color="red",fill="red", alpha=0.7)+
geom_point(color="red",fill="red", alpha=0.7)+
geom_violin(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue", fill="blue", alpha=0.7, width = 0.5)+
geom_point(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue",fill="red", alpha=0.7)+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
slopes %>% filter(Treatment=="Intact", !is.na(Slopes_dif_mgC)) %>%
ggplot(aes(x=Species,y=-Slopes_dif_mgC))+
geom_point(color="red",fill="red", alpha=0.7)+
geom_point(data=slopes %>% filter(Treatment=="Anesthetized", !is.na(Slopes_dif_mgC)), color="blue",fill="red", alpha=0.7)+
ylab("Net respiration rate (pgO2/min) / Specimen carbon (mg)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
### COST OF TRANSPORT ###
#Get swimming speeds
salplit <- read.csv("salplit.tsv", sep='\t', stringsAsFactors = F)
swimraw <- salplit[,c(1,2,4)] %>% filter(Variable=="Mean swimming speed cms")
swim <- data.frame(Species=swimraw$Species, Speed.cm.s=as.numeric(swimraw$Value))
swim <- read.csv("SalpPreliminaryPass.tsv",sep='\t', stringsAsFactors = F)[,c(1,15)]
swim <- swim[!is.na(swim$Speed..cm.s.),]
names(swim)[2] <- "Speed.cm.s"
#### CAUTION ##### WE ARE SWAPPING NAMES HERE
swim$Species[swim$Species=="Helicosalpa younti"] <- "Helicosalpa virgula"
swim$Species[swim$Species=="Pegea socia"] <- "Pegea sp."
swim$Species[swim$Species=="Ritteriella retracta"] <- "Ritteriella sp."
swim$Species[swim$Species=="Rittereilla amboinensis"] <- "Ritteriella amboinensis"
swim$Species[swim$Species=="Thalia democratica"] <- "Thalia sp."
energetics <- mutate(slopes, Species=as.character(Species))
energetics$Species[energetics$Species=="Iasis (Weelia) cylindrica"] <- "Iasis cylindrica"
energetics <- left_join(energetics, swim, by="Species")
energetics$Zooid.length..mm. <- as.numeric(energetics$Zooid.length..mm.)
energetics$Number.of.zooids <- as.numeric(energetics$Number.of.zooids)
energetics %>% mutate(Speed.body.s = 10*Speed.cm.s/Zooid.length..mm.) -> energetics #speed per body lengths
energetics %>% group_by(Species) %>% summarize(-Slope_O2_dif_normalized %>% mean(na.rm=T))
#Define COST of LIVING: COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
energetics %>% filter(energetics$Treatment=="Intact") %>%
mutate(COT.abs.ml = -Slope_O2_dif_normalized/(Speed.cm.s*60),
COT.rel.ml = -Slope_O2_dif_normalized/(Speed.body.s*60),
COT.abs.mgC = -Slope_O2_dif_normalized/(Speed.cm.s*60),
COT.rel.mgC = -Slope_O2_dif_normalized/(Speed.body.s*60)) -> COT_intact
COT_intact <- COT_intact[which(!is.na(COT_intact$COT.abs.ml)),]
COT_intact$Species %>% factor(levels=c("Pegea sp.", "Helicosalpa virgula","Cyclosalpa affinis",
"Cyclosalpa bakeri", "Cyclosalpa quadriluminis","Cyclosalpa polae",
"Cyclosalpa sewelli", "Ritteriella sp.", "Ritteriella amboinensis",
"Brooksia rostrata", "Thalia sp.", "Metcalfina hexagona", "Salpa fusiformis", "Salpa aspera", "Salpa maxima",
"Iasis cylindrica", "Soestia zonaria")) -> COT_intact$Species
#raw cost of living by volume per cm
pdf("Figures_respirometry/Kona2022/rawCOT_intact_abs.pdf", height=6, width=10)
COT_intact %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species,y=COT.abs.ml))+
geom_boxplot(aes(fill=Speed.cm.s))+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per cm moved)") #+ ylim(c(0, 7e-05))
dev.off()
COT_intact %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species,y=COT.abs.ml))+
geom_boxplot(aes(fill=Speed.cm.s))+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per cm moved)") #+ ylim(c(0, 7e-05))
COT_intact
energetics
swim$Species
swim
swim <- read.csv("SalpPreliminaryPass.tsv",sep='\t', stringsAsFactors = F)[,c(1,15)]
swim <- swim[!is.na(swim$Speed..cm.s.),]
names(swim)[2] <- "Speed.cm.s"
swim
swim <- read.csv("SalpPreliminaryPass.tsv",sep='\t', stringsAsFactors = F)[,c(1,15)]
swim <- swim[!is.na(swim$Speed..cm.s.),]
names(swim)[2] <- "Speed.cm.s"
#### CAUTION ##### WE ARE SWAPPING NAMES HERE
swim$Species[swim$Species=="Pegea socia"] <- "Pegea sp."
swim$Species[swim$Species=="Ritteriella retracta"] <- "Ritteriella sp."
swim$Species[swim$Species=="Rittereilla amboinensis"] <- "Ritteriella amboinensis"
swim$Species[swim$Species=="Thalia democratica"] <- "Thalia sp."
energetics <- mutate(slopes, Species=as.character(Species))
energetics$Species[energetics$Species=="Iasis (Weelia) cylindrica"] <- "Iasis cylindrica"
energetics <- left_join(energetics, swim, by="Species")
energetics$Zooid.length..mm. <- as.numeric(energetics$Zooid.length..mm.)
energetics$Number.of.zooids <- as.numeric(energetics$Number.of.zooids)
energetics %>% mutate(Speed.body.s = 10*Speed.cm.s/Zooid.length..mm.) -> energetics #speed per body lengths
energetics %>% group_by(Species) %>% summarize(-Slope_O2_dif_normalized %>% mean(na.rm=T))
energetics %>% filter(Species=="Helicosalpa virgula")
#Define COST of LIVING: COT.abs as mgO2/(Zooid.vol*cm_moved)  v.v. COT.rel as mgO2/(Zooid.vol*bodylength)
energetics %>% filter(energetics$Treatment=="Intact") %>%
mutate(COT.abs.ml = -Slope_O2_dif_normalized/(Speed.cm.s*60),
COT.rel.ml = -Slope_O2_dif_normalized/(Speed.body.s*60),
COT.abs.mgC = -Slope_O2_dif_normalized/(Speed.cm.s*60),
COT.rel.mgC = -Slope_O2_dif_normalized/(Speed.body.s*60)) -> COT_intact
COT_intact <- COT_intact[which(!is.na(COT_intact$COT.abs.ml)),]
COT_intact %>% filter(Species=="Helicosalpa virgula")
COT_intact$Species %>% factor(levels=c("Pegea sp.", "Helicosalpa virgula","Cyclosalpa affinis",
"Cyclosalpa bakeri", "Cyclosalpa quadriluminis","Cyclosalpa polae",
"Cyclosalpa sewelli", "Ritteriella sp.", "Ritteriella amboinensis",
"Brooksia rostrata", "Thalia sp.", "Metcalfina hexagona", "Salpa fusiformis", "Salpa aspera", "Salpa maxima",
"Iasis cylindrica", "Soestia zonaria")) -> COT_intact$Species
COT_intact %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species,y=COT.abs.ml))+
geom_boxplot(aes(fill=Speed.cm.s))+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per cm moved)") #+ ylim(c(0, 7e-05))
COT_intact %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species,y=COT.abs.ml))+
geom_boxplot(aes(fill=Speed.cm.s))+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per cm moved)") #+ ylim(c(0, 7e-05))
COT_intact %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species,y=COT.abs.ml))+
geom_boxplot(aes(fill=Speed.cm.s))+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+scale_fill_continuous("white","red")+ylab("Gross Cost of Transport (pgO2/Biovolume per cm moved)") #+ ylim(c(0, 7e-05))
COT_intact %>% filter(!is.na(COT.rel.ml)) %>%
ggplot(aes(x=Species,y=COT.rel.ml))+
geom_boxplot(aes(fill=Speed.cm.s))+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per zooid length moved)")  #+ ylim(c(0, 6e-05))
COT_intact %>% filter(!is.na(COT.abs.mgC)) %>%
ggplot(aes(x=Species,y=COT.abs.mgC))+
geom_boxplot(aes(fill=Speed.cm.s))+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/mgC per cm moved)") #+ ylim(c(0, 6e-05))
COT_intact %>% filter(!is.na(COT.rel.mgC)) %>%
ggplot(aes(x=Species,y=COT.rel.mgC))+
geom_boxplot(aes(fill=Speed.cm.s))+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/mgC per zooid length moved)")
#COT for paired species
COT <- energetics[,c("Species","Specimen","Colony.volume..ml.","Zooid.length..mm.","Number.of.zooids","Treatment","Paired","Slope_O2_dif_normalized","Slopes_dif_mgC","Speed.cm.s","Speed.body.s")]
##### WARNING ##### SKETCHY STUFF TO REMOVE NEGATIVES !!!!
COT$Slope_O2_dif_normalized[which(COT$Slope_O2_dif_normalized>0)] <- 0
COT %>% filter(Paired=="Yes") %>%
pivot_wider(names_from = Treatment, values_from = c(Slope_O2_dif_normalized, Slopes_dif_mgC)) %>%
mutate(COT.abs.ml = -(Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/(Speed.cm.s*60),
COT.rel.ml = -(Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/(Speed.body.s*60)) %>%
mutate(COT.abs.mgC = -(Slopes_dif_mgC_Intact-Slopes_dif_mgC_Anesthetized)/(Speed.cm.s*60),
COT.rel.mgC = -(Slopes_dif_mgC_Intact-Slopes_dif_mgC_Anesthetized)/(Speed.body.s*60)) -> COT_paired
#COT by biovolume per cm across species
COT_paired %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species,y=(COT.abs.ml) ))+
geom_boxplot(aes(col=Speed.cm.s, fill= Speed.cm.s))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
ylab("Net cost of Transport (pgO2/ml per cm moved)")
#COT by biovolume per zooid length across species
COT_paired %>% filter(!is.na(COT.rel.ml)) %>%
ggplot(aes(x=Species,y=(COT.rel.ml) ))+
geom_boxplot(aes(col=Speed.cm.s, fill= Speed.cm.s))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
ylab("Net cost of Transport (pgO2/ml per zooid length moved)")
#COT by mgC per cm across species
COT_paired %>% filter(!is.na(COT.abs.mgC)) %>%
ggplot(aes(x=Species,y=(COT.abs.mgC) ))+
geom_boxplot()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
ylab("Net cost of Transport (pgO2/mgC per cm moved)")
#COT by mgC per zooid length across species
COT_paired %>% filter(!is.na(COT.rel.mgC)) %>%
ggplot(aes(x=Species,y=COT.rel.mgC ))+
geom_boxplot()+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
ylab("Net cost of Transport (pgO2/mgC per zooid length moved)")
###  COT paired by species   ###
COT %>% filter(!is.na(Species)) %>%
pivot_wider(names_from = Treatment, values_from = c(Slope_O2_dif_normalized, Slopes_dif_mgC)) %>%
group_by(Species) %>%
summarise_at(vars("Speed.cm.s", "Speed.body.s", "Slope_O2_dif_normalized_Intact", "Slope_O2_dif_normalized_Anesthetized", "Slopes_dif_mgC_Intact", "Slopes_dif_mgC_Anesthetized", "Zooid.length..mm."),
function(x){median(x, na.rm=T)}) %>% as.data.frame() -> COT_species
#Systemic corrections
COT_species[,c(1,4,5)] -> playDF
## Calculate maximum negative deviation between intact and anesthetized across species
max(playDF[which(playDF$Slope_O2_dif_normalized_Intact>
playDF$Slope_O2_dif_normalized_Anesthetized),"Slope_O2_dif_normalized_Intact"]-
playDF[which(playDF$Slope_O2_dif_normalized_Intact>
playDF$Slope_O2_dif_normalized_Anesthetized),"Slope_O2_dif_normalized_Anesthetized"]) -> Intact_systemic_correction
playDF$Slope_O2_dif_normalized_Intact <- playDF$Slope_O2_dif_normalized_Intact - Intact_systemic_correction
playDF %>%  mutate(Percent=100*round((Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/Slope_O2_dif_normalized_Intact,6))-> playDF
playDF
COT_species[,c("Slope_O2_dif_normalized_Intact","Slope_O2_dif_normalized_Anesthetized")] <- playDF[,c("Slope_O2_dif_normalized_Intact","Slope_O2_dif_normalized_Anesthetized")]
COT_species %>% mutate(COT.abs.ml = -(Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/(Speed.cm.s*60),
COT.rel.ml = -(Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/(Speed.body.s*60)) %>%
mutate(COT.abs.mgC = -(Slopes_dif_mgC_Intact-Slopes_dif_mgC_Anesthetized)/(Speed.cm.s*60),
COT.rel.mgC = -(Slopes_dif_mgC_Intact-Slopes_dif_mgC_Anesthetized)/(Speed.body.s*60)) %>%
mutate(COT.p.ml = -100*(Slope_O2_dif_normalized_Anesthetized-Slope_O2_dif_normalized_Intact)/Slope_O2_dif_normalized_Intact,
COT.p.mgC = -100*(Slopes_dif_mgC_Anesthetized-Slopes_dif_mgC_Intact)/Slopes_dif_mgC_Intact) %>%
mutate(COL.abs.ml = -Slope_O2_dif_normalized_Intact/(Speed.cm.s*60),
COL.rel.ml = -Slope_O2_dif_normalized_Intact/(Speed.body.s*60),
COL.abs.mgC = -Slope_O2_dif_normalized_Intact/(Speed.cm.s*60),
COL.rel.mgC = -Slope_O2_dif_normalized_Intact/(Speed.body.s*60))-> COT_species
#order species as factors by architecture
COT_species$Species %>% factor(levels=c("Pegea sp.", "Helicosalpa virgula","Cyclosalpa affinis",
"Cyclosalpa bakeri", "Cyclosalpa quadriluminis","Cyclosalpa polae",
"Cyclosalpa sewelli", "Ritteriella sp.", "Ritteriella amboinensis",
"Brooksia rostrata", "Thalia sp.", "Metcalfina hexagona", "Salpa fusiformis", "Salpa aspera", "Salpa maxima",
"Iasis cylindrica", "Soestia zonaria")) -> COT_species$Species
#COT_species <- filter(COT_species, Species != "Cyclosalpa bakeri")  ### REMOVED OUTLIER WONKY SPP !!!
COT_species[,c(1,15,9,13)]
#Net respiration rate by biovolume in Swimmers and KO
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_point(aes(y=(-Slope_O2_dif_normalized_Intact)),color="red", alpha=0.7)+
geom_point(aes(y=(-Slope_O2_dif_normalized_Anesthetized)), color="blue",alpha=0.7)+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
#COT by biovolume per cm across absolute speeds
ggplot(COT_species %>% filter(!is.na(COT.abs.ml)), aes(x=Speed.cm.s,y=COT.abs.ml))+
geom_point(aes(color=Speed.body.s ),cex=3)+
theme_bw()+
geom_text(label=COT_species %>% filter(!is.na(COT.abs.ml)) %>% .$Species, hjust=0.4, vjust=-0.7)+
ylab("Net cost of Transport (pgO2/ml per cm moved)")
#COT by biovolume per cm across relative speeds
ggplot(COT_species %>% filter(!is.na(COT.abs.ml)), aes(x=Speed.body.s,y=COT.abs.ml))+
geom_point(aes(color=Speed.cm.s ),cex=3)+
theme_bw()+
geom_text(label=COT_species %>% filter(!is.na(COT.abs.ml)) %>% .$Species, hjust=0.4, vjust=-0.7)+
ylab("Net cost of Transport (pgO2/ml per body length moved)")
#COT by biovolume per cm across absolute speeds
ggplot(COT_species %>% filter(!is.na(COT.abs.ml)), aes(x=Speed.cm.s,y=COT.abs.ml))+
#geom_point(aes(color=Speed.body.s ),cex=3)+
theme_bw()+
geom_text(label=COT_species %>% filter(!is.na(COT.abs.ml)) %>% .$Species, hjust=0.4, vjust=-0.7)+
ylab("Net cost of Transport (pgO2/ml per cm moved)")
COT_intact %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species,y=COT.abs.ml))+
geom_boxplot(aes(fill=Speed.cm.s))+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per cm moved)") #+ ylim(c(0, 7e-05))
theme_bw()+theme(axis.text.x = element_text(angle = 90))+scale_fill_gradient("white","red")+ylab("Gross Cost of Transport (pgO2/Biovolume per cm moved)") #+ ylim(c(0, 7e-05))
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per cm moved)")+scale_fill_gradient("white","red") #+ ylim(c(0, 7e-05))
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per cm moved)")+scale_fill_gradient("white","red") #+ ylim(c(0, 7e-05))
COT_intact %>% filter(!is.na(COT.rel.ml)) %>%
ggplot(aes(x=Species,y=COT.rel.ml))+
geom_boxplot(aes(fill=Speed.cm.s))+
scale_fill_gradient("white","red")+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per zooid length moved)")  #+ ylim(c(0, 6e-05))
COT_intact %>% filter(!is.na(COT.rel.ml)) %>%
ggplot(aes(x=Species,y=COT.rel.ml))+
geom_boxplot(aes(fill=Speed.cm.s))+
scale_fill_gradient(min="white",max="red")+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per zooid length moved)")  #+ ylim(c(0, 6e-05))
COT_intact %>% filter(!is.na(COT.rel.ml)) %>%
ggplot(aes(x=Species,y=COT.rel.ml))+
geom_boxplot(aes(fill=Speed.cm.s))+
scale_fill_gradient(low="white",high="red")+
theme_bw()+theme(axis.text.x = element_text(angle = 90))+ylab("Gross Cost of Transport (pgO2/Biovolume per zooid length moved)")  #+ ylim(c(0, 6e-05))
slopes %>% filter(Treatment=="Intact") %>%
ggplot(aes(x=Species,y=-Slope_O2_dif_normalized))+
geom_violin(color="red",fill="red", alpha=0.7)+
geom_point(color="red",fill="red", alpha=0.7)+
geom_violin(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue", fill="blue", alpha=0.7, width = 0.5)+
geom_point(data=slopes %>% filter(Treatment=="Anesthetized"), color="blue",fill="red", alpha=0.7)+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
#COT by biovolume per cm across species
COT_paired %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species,y=(COT.abs.ml) ))+
geom_boxplot(aes(col=Speed.cm.s, fill= Speed.cm.s))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
ylab("Net cost of Transport (pgO2/ml per cm moved)")
#Systemic corrections
COT_species[,c(1,4,5)] -> playDF
## Calculate maximum negative deviation between intact and anesthetized across species
max(playDF[which(playDF$Slope_O2_dif_normalized_Intact>
playDF$Slope_O2_dif_normalized_Anesthetized),"Slope_O2_dif_normalized_Intact"]-
playDF[which(playDF$Slope_O2_dif_normalized_Intact>
playDF$Slope_O2_dif_normalized_Anesthetized),"Slope_O2_dif_normalized_Anesthetized"]) -> Intact_systemic_correction
playDF$Slope_O2_dif_normalized_Intact <- playDF$Slope_O2_dif_normalized_Intact - Intact_systemic_correction
playDF %>%  mutate(Percent=100*round((Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/Slope_O2_dif_normalized_Intact,6))-> playDF
playDF
COT_species[,c("Slope_O2_dif_normalized_Intact","Slope_O2_dif_normalized_Anesthetized")] <- playDF[,c("Slope_O2_dif_normalized_Intact","Slope_O2_dif_normalized_Anesthetized")]
COT_species %>% mutate(COT.abs.ml = -(Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/(Speed.cm.s*60),
COT.rel.ml = -(Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/(Speed.body.s*60)) %>%
mutate(COT.abs.mgC = -(Slopes_dif_mgC_Intact-Slopes_dif_mgC_Anesthetized)/(Speed.cm.s*60),
COT.rel.mgC = -(Slopes_dif_mgC_Intact-Slopes_dif_mgC_Anesthetized)/(Speed.body.s*60)) %>%
mutate(COT.p.ml = -100*(Slope_O2_dif_normalized_Anesthetized-Slope_O2_dif_normalized_Intact)/Slope_O2_dif_normalized_Intact,
COT.p.mgC = -100*(Slopes_dif_mgC_Anesthetized-Slopes_dif_mgC_Intact)/Slopes_dif_mgC_Intact) %>%
mutate(COL.abs.ml = -Slope_O2_dif_normalized_Intact/(Speed.cm.s*60),
COL.rel.ml = -Slope_O2_dif_normalized_Intact/(Speed.body.s*60),
COL.abs.mgC = -Slope_O2_dif_normalized_Intact/(Speed.cm.s*60),
COL.rel.mgC = -Slope_O2_dif_normalized_Intact/(Speed.body.s*60))-> COT_species
#order species as factors by architecture
COT_species$Species %>% factor(levels=c("Pegea sp.", "Helicosalpa virgula","Cyclosalpa affinis",
"Cyclosalpa bakeri", "Cyclosalpa quadriluminis","Cyclosalpa polae",
"Cyclosalpa sewelli", "Ritteriella sp.", "Ritteriella amboinensis",
"Brooksia rostrata", "Thalia sp.", "Metcalfina hexagona", "Salpa fusiformis", "Salpa aspera", "Salpa maxima",
"Iasis cylindrica", "Soestia zonaria")) -> COT_species$Species
#COT_species <- filter(COT_species, Species != "Cyclosalpa bakeri")  ### REMOVED OUTLIER WONKY SPP !!!
COT_species[,c(1,15,9,13)]
#Net respiration rate by biovolume in Swimmers and KO
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_point(aes(y=(-Slope_O2_dif_normalized_Intact)),color="red", alpha=0.7)+
geom_point(aes(y=(-Slope_O2_dif_normalized_Anesthetized)), color="blue",alpha=0.7)+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
#COT by biovolume per cm across absolute speeds
ggplot(COT_species %>% filter(!is.na(COT.abs.ml)), aes(x=Speed.cm.s,y=COT.abs.ml))+
#geom_point(aes(color=Speed.body.s ),cex=3)+
theme_bw()+
geom_text(label=COT_species %>% filter(!is.na(COT.abs.ml)) %>% .$Species, hjust=0.4, vjust=-0.7)+
ylab("Net cost of Transport (pgO2/ml per cm moved)")
#COT by biovolume per cm across relative speeds
ggplot(COT_species %>% filter(!is.na(COT.abs.ml)), aes(x=Speed.body.s,y=COT.abs.ml))+
geom_point(aes(color=Speed.cm.s ),cex=3)+
theme_bw()+
geom_text(label=COT_species %>% filter(!is.na(COT.abs.ml)) %>% .$Species, hjust=0.4, vjust=-0.7)+
ylab("Net cost of Transport (pgO2/ml per body length moved)")
#COT by biovolume per cm across species
ggplot(COT_species %>% filter(!is.na(COT.abs.ml)), aes(x=Species,y=COT.abs.ml))+
geom_point(aes(color=Speed.cm.s))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
ylab("Net cost of Transport (pgO2/mgC per cm moved)")
###  COT paired by species   ###
COT %>% filter(!is.na(Species)) %>%
pivot_wider(names_from = Treatment, values_from = c(Slope_O2_dif_normalized, Slopes_dif_mgC)) %>%
group_by(Species) %>%
summarise_at(vars("Speed.cm.s", "Speed.body.s", "Slope_O2_dif_normalized_Intact", "Slope_O2_dif_normalized_Anesthetized", "Slopes_dif_mgC_Intact", "Slopes_dif_mgC_Anesthetized", "Zooid.length..mm."),
function(x){median(x, na.rm=T)}) %>% as.data.frame() -> COT_species
#Systemic corrections
COT_species[,c(1,4,5)] -> playDF
## Calculate maximum negative deviation between intact and anesthetized across species
max(playDF[which(playDF$Slope_O2_dif_normalized_Intact>
playDF$Slope_O2_dif_normalized_Anesthetized),"Slope_O2_dif_normalized_Intact"]-
playDF[which(playDF$Slope_O2_dif_normalized_Intact>
playDF$Slope_O2_dif_normalized_Anesthetized),"Slope_O2_dif_normalized_Anesthetized"]) -> Intact_systemic_correction
playDF$Slope_O2_dif_normalized_Intact <- playDF$Slope_O2_dif_normalized_Intact - Intact_systemic_correction
playDF %>%  mutate(Percent=100*round((Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/Slope_O2_dif_normalized_Intact,6))-> playDF
playDF
COT_species[,c("Slope_O2_dif_normalized_Intact","Slope_O2_dif_normalized_Anesthetized")] <- playDF[,c("Slope_O2_dif_normalized_Intact","Slope_O2_dif_normalized_Anesthetized")]
COT_species %>% mutate(COT.abs.ml = -(Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/(Speed.cm.s*60),
COT.rel.ml = -(Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized)/(Speed.body.s*60)) %>%
mutate(COT.abs.mgC = -(Slopes_dif_mgC_Intact-Slopes_dif_mgC_Anesthetized)/(Speed.cm.s*60),
COT.rel.mgC = -(Slopes_dif_mgC_Intact-Slopes_dif_mgC_Anesthetized)/(Speed.body.s*60)) %>%
mutate(COT.p.ml = -100*(Slope_O2_dif_normalized_Anesthetized-Slope_O2_dif_normalized_Intact)/Slope_O2_dif_normalized_Intact,
COT.p.mgC = -100*(Slopes_dif_mgC_Anesthetized-Slopes_dif_mgC_Intact)/Slopes_dif_mgC_Intact) %>%
mutate(COL.abs.ml = -Slope_O2_dif_normalized_Intact/(Speed.cm.s*60),
COL.rel.ml = -Slope_O2_dif_normalized_Intact/(Speed.body.s*60),
COL.abs.mgC = -Slope_O2_dif_normalized_Intact/(Speed.cm.s*60),
COL.rel.mgC = -Slope_O2_dif_normalized_Intact/(Speed.body.s*60))-> COT_species
#order species as factors by architecture
COT_species$Species %>% factor(levels=c("Pegea sp.", "Helicosalpa virgula","Cyclosalpa affinis",
"Cyclosalpa bakeri", "Cyclosalpa quadriluminis","Cyclosalpa polae",
"Cyclosalpa sewelli", "Ritteriella sp.", "Ritteriella amboinensis",
"Brooksia rostrata", "Thalia sp.", "Metcalfina hexagona", "Salpa fusiformis", "Salpa aspera", "Salpa maxima",
"Iasis cylindrica", "Soestia zonaria")) -> COT_species$Species
#COT_species <- filter(COT_species, Species != "Cyclosalpa bakeri")  ### REMOVED OUTLIER WONKY SPP !!!
COT_species[,c(1,15,9,13)]
#Net respiration rate by biovolume in Swimmers and KO
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_point(aes(y=(-Slope_O2_dif_normalized_Intact)),color="red", alpha=0.7)+
geom_point(aes(y=(-Slope_O2_dif_normalized_Anesthetized)), color="blue",alpha=0.7)+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_boxplot(aes(y=Slope_O2_dif_normalized_Intact-Slope_O2_dif_normalized_Anesthetized))+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_boxplot(aes(y=Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized))+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_boxplot(aes(y=-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized))+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_barplot(aes(y=-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized))+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_bar(aes(y=-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized))+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_bar(aes(y=-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized))+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_point(aes(y=-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized))+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_line(aes(y=-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized))+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
GeomBoxplot(aes(y=-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized))+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_boxplot(aes(y=-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized))+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_bar(aes(y=-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized), stat=NA)+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_bar(aes(y=-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized), stat="identity")+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_bar(aes(y=1-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized), stat="identity")+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_bar(aes(y=10-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized), stat="identity")+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_bar(aes(y=5-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized), stat="identity")+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
slopes %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_bar(aes(y=5-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized), stat="identity")+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
slopes %>%
ggplot(aes(x=Species))+
geom_bar(aes(y=5-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized), stat="identity")+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
COT_species %>% filter(!is.na(COT.abs.ml)) %>%
ggplot(aes(x=Species))+
geom_bar(aes(y=5-Slope_O2_dif_normalized_Intact+Slope_O2_dif_normalized_Anesthetized), stat="identity")+
ylab("Net respiration rate (pgO2/min) per specimen biovolume (ml)")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))
