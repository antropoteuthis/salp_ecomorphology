ggplot(COT_species %>% filter(!is.na(COT.rel.mgC)), aes(x=Species,y=COT.rel.mgC))+
geom_point(aes(size=Zooid.length..mm.,color=Speed.body.s))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
ylab("Cost of Transport (pgO2/mgC per body length moved)")
#COT by mgC per zooid length across species
ggplot(COT_species %>% filter(!is.na(COT.rel.mgC)), aes(x=Species,y=COT.rel.mgC))+
geom_point(aes(size=Zooid.length..mm.,color=BLperSecond))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
ylab("Cost of Transport (pgO2/mgC per body length moved)")
ggplot(COT_with_means %>% filter(!is.na(COT.p.ml) & Species != "Brooksia rostrata" & Architecture != "Whorl chain"),
aes(x = factor(Species %>% as.character(), levels = unique(Species[order(factor(Architecture, levels = architecture_order))])),
y = COT.p.ml, fill = Architecture)) +
stat_summary(fun = "mean", geom = "bar", position = "dodge") +
stat_summary(fun.data = "mean_se", geom = "errorbar", position = "dodge", width = 0.25) +  # Add error bars
scale_fill_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw() +
xlab("Species") +
ylab("Proportion of Metabolic Cost Spent on Swimming (%)") +theme_bw()+theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust=0.5))
ggplot(COT_species %>%  filter(!is.na(COT.p.ml) & Species != "Thalia sp."), aes(x = COT.rel.ml,y=COT.p.ml))+
geom_point(size=2,aes(col=Architecture))+
geom_smooth(method="gam")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
# ylim(c(0,100))+
xlab("Net cost of Transport (pgO2/ml per body length moved)")+
ylab("% Cost of Transport Volume-normalized")
# % cost (by biovolume) invested in swimming across species order: COT.p, , by: Speed mm/s
ggplot(COT_species %>%  filter(!is.na(COT.p.ml)), aes(x = Speed.mm.s,y=COT.p.ml))+
geom_point(size=2,aes(col=Architecture))+
geom_smooth(method="gam")+
geom_text(label=COT_species %>% filter(!is.na(COT.p.ml)) %>% .$Species, hjust=0.4, vjust=-0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
# ylim(c(0,100))+
xlab("Speed (mm/s)")+
ylab("% Cost of Transport Volume-normalized")
# % cost (by biovolume) invested in swimming across species order: COT.p, , by: Speed mm/s
ggplot(COT_species %>%  filter(!is.na(COT.p.ml)), aes(x = Speed_mm_s,y=COT.p.ml))+
geom_point(size=2,aes(col=Architecture))+
geom_smooth(method="gam")+
geom_text(label=COT_species %>% filter(!is.na(COT.p.ml)) %>% .$Species, hjust=0.4, vjust=-0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
# ylim(c(0,100))+
xlab("Speed (mm/s)")+
ylab("% Cost of Transport Volume-normalized")
ggplot(COT_species %>%  filter(!is.na(COT.p.ml)), aes(x = reorder(Species %>% as.character(), COL.abs.ml),y=COT.p.ml))+
geom_point(aes(size=Zooid.length..mm.,color=COL.abs.ml))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
# ylim(c(0,100))+
xlab("Species")+
ylab("% Cost of Transport Volume-normalized")
ggplot(COT_species %>%  filter(!is.na(COT.p.ml)), aes(x = Speed.mm.s,y=COT.p.ml))+
geom_point(aes(color=Species))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
#ylim(c(0,100))+
ylab("% Cost of Transport Volume-normalized")
# % cost (by biovolume) invested in swimming across absolute SPEED , color: Species
ggplot(COT_species %>%  filter(!is.na(COT.p.ml)), aes(x = Speed_mm_s,y=COT.p.ml))+
geom_point(aes(color=Species))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
#ylim(c(0,100))+
ylab("% Cost of Transport Volume-normalized")
# % cost (by biovolume) invested in swimming across relative SPEED , color: Species
ggplot(COT_species %>%  filter(!is.na(COT.p.ml) & !is.na(Species)), aes(x = BLperSecond,y=COT.p.ml))+
geom_point(aes(size=Zooid.length..mm.,color=Species))+
geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species)) %>% .$Species, hjust=0.4, vjust=-0.7)+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
ylab("% Cost of Transport Volume-normalized")
ggplot(COT_species %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"), aes(x = Pulses_per_second, y=COT.p.ml))+
geom_point(aes(col = Architecture))+
geom_smooth(method="lm", color="white")+
geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain") %>%
.$Species, hjust=0.4, vjust=-0.7, color="white", cex=3)+
scale_color_manual(values = c("cyan4", "red1", "darkorange1", "magenta", "gold1", "darkorchid4", "green4")[c(1, 4, 5, 3, 2, 7, 6)]) +
xlab("Puslation rate (pulses/s)") +
ylab("Proportion of Metabolic Cost Spent on Swimming (%)")+ theme_dark()+ theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust=0.5, color = "white"),
axis.text.y = element_text(color = "white"),
panel.grid.major = element_blank(),  # Remove major grid lines
panel.grid.minor = element_blank(),  # Remove minor grid lines
axis.line = element_line(color = "white"),  # Set axis line color to black
text = element_text(color = "white"),  # Set text color to white
panel.background = element_rect(fill = "black")  # Set panel background color to black
)
glm(COT.p.ml ~ Pulses_per_second, data = COT_species %>%
filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Brooksia rostrata"),
family = gaussian(link = "identity")) %>% summary()
ggplot(COT_species %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Brooksia rostrata"),
aes(x = Pulses_per_second, y=COT.p.ml))+
geom_point(aes(col = Architecture))+
geom_smooth(method="lm", color="black")+
geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"  & Species != "Brooksia rostrata") %>%
.$Species, hjust=0.4, vjust=-0.7, color="black", cex=3)+
scale_color_manual(values = c("cyan4", "red1", "darkorange1", "magenta", "gold1", "darkorchid4", "green4")[c(1, 4, 5, 3, 2, 7, 6)]) +
xlab("Puslation rate (pulses/s)") +
ylab("Proportion of Metabolic Cost Spent on Swimming (%)")+ theme_bw()
ggplot(COT_species %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"),
aes(x = Pulses_per_second, y=COT.p.ml))+
geom_point(aes(col = Architecture))+
geom_smooth(method="lm", color="black")+
geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"  & Species != "Brooksia rostrata") %>%
.$Species, hjust=0.4, vjust=-0.7, color="black", cex=3)+
scale_color_manual(values = c("cyan4", "red1", "darkorange1", "magenta", "gold1", "darkorchid4", "green4")[c(1, 4, 5, 3, 2, 7, 6)]) +
xlab("Puslation rate (pulses/s)") +
ylab("Proportion of Metabolic Cost Spent on Swimming (%)")+ theme_bw()
COT_means <- COT_with_means %>%
filter(COT.p.ml>0 & !is.na(Species) & Architecture != "Whorl chain") %>%
group_by(Species, Architecture) %>%
summarise(mean_COT = mean(COT.p.ml),
mean_Pulses_per_second = mean(Pulses_per_second))
ggplot(COT_with_means %>%
filter(COT.p.ml>0 & !is.na(Species) & Architecture != "Whorl chain" & Species != "Brooksia rostrata"),
aes(x = Pulses_per_second, y = COT.p.ml)) +
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_smooth(method = "lm", color = "black") +
geom_text(data = COT_means %>% filter(Architecture %in% unique(COT_with_means$Architecture)),
aes(label = Species, x = mean_Pulses_per_second, y = mean_COT),
hjust = 0.4, vjust = -0.7, color = "black", cex = 3) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlab("Pulsation rate (pulses/s)") +
ylab("Proportion of Metabolic Cost Spent on Swimming (%)") +
theme_bw()
glm(COT.p.ml ~ Pulses_per_second,
data = COT_with_means %>%
filter(COT.p.ml>0 & !is.na(Species) & Architecture != "Whorl chain"),
family = gaussian(link = "identity")) %>% summary()
glm(COT.p.ml ~ Speed_mm_s, data = COT_with_means %>%
filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"),
family = gaussian(link = "identity")) %>% summary()
glm(COT.p.ml ~ BLperSecond, data = COT_with_means %>%
filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"),
family = gaussian(link = "identity")) %>% summary()
wrap_plots(IvS1, IvS2)
# % cost (by biovolume) invested in swimming across COT_vol_mm , color: Species
ggplot(COT_species %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"), aes(y = COT.abs.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="white")+
geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain") %>%
.$Species, hjust=0.4, vjust=-0.7, color="white")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("cyan4", "red1", "darkorange1", "magenta", "gold1", "darkorchid4", "green4")[c(1, 4, 5, 3, 2, 7, 6)]) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")+ theme_dark()+ theme(
axis.text.x = element_text(angle = 90, hjust = 1, vjust=0.5, color = "white"),
axis.text.y = element_text(color = "white"),
panel.grid.major = element_blank(),  # Remove major grid lines
panel.grid.minor = element_blank(),  # Remove minor grid lines
axis.line = element_line(color = "white"),  # Set axis line color to black
text = element_text(color = "white"),  # Set text color to white
panel.background = element_rect(fill = "black"),  # Set panel background color to black
axis.ticks = element_line(color = "white")
)
ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="black")+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("cyan4", "red1", "darkorange1", "magenta", "gold1", "darkorchid4", "green4")[c(1, 4, 5, 3, 2, 7, 6)]) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")+ theme_bw()
ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="black")+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)")
Sm6A <- ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="black", formula = log(y)~x)+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")
Sm6A <- ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="black", formula = y~log(x))+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")
Sm6A
Sm6A <- ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="black", formula = log(y)~x)+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")
Sm6A
Sm6A <- ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="black", formula = e^(y)~x)+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")
ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="black", formula = e^(y)~x)+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")
ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="black", formula = y ~ exp(x))+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")
ggplot(COT_species %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="black")+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")
ggplot(COT_species %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"), aes(y = COT.rel.ml,x=COT.p.ml))+
geom_point(aes(color=Architecture))+
geom_smooth(method="lm", color="black")+
geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain") %>%
.$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("cyan4", "red1", "darkorange1", "magenta", "gold1", "darkorchid4", "green4")[c(1, 4, 5, 3, 2, 7, 6)]) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per zooid length moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)")
Sm6A <- ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_smooth(method="lm", color="black")+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")
Sm6B <- ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"), aes(y = COT.rel.ml,x=COT.p.ml))+
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_smooth(method="lm", color="black")+
geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain") %>%
.$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per zooid length moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)")
wrap_plots(Sm6A, Sm6B)
ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"), aes(y = COT.rel.ml,x=COT.p.ml))+
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_smooth(method="lm", color="black")+
geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain") %>%
.$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per zooid length moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)")
ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain"), aes(y = COT.rel.ml,x=COT.p.ml))+
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_smooth(method="lm", color="black")+
theme_bw()+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per zooid length moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)")
ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Species!="Thalia sp."), aes(y = COT.rel.ml,x=COT.p.ml))+
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_smooth(method="lm", color="black")+
theme_bw()+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per zooid length moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)")
ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_smooth(method="lm", color="black")+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")
Sm6A <- ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Species != "Thalia sp."),
aes(y = COT.abs.ml,x=COT.p.ml))+
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_smooth(method="lm", color="black")+
# geom_text(label=COT_species %>% filter(!is.na(COT.p.ml) & !is.na(Species) & Architecture != "Whorl chain" & Species != "Thalia sp.") %>%
#            .$Species, hjust=0.4, vjust=-0.7, color="black")+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per mm moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)") + guides(color="none")
Sm6B <- ggplot(COT_with_means %>%  filter(!is.na(COT.p.ml) & !is.na(Species) & Species!="Thalia sp."), aes(y = COT.rel.ml,x=COT.p.ml))+
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_smooth(method="lm", color="black")+
theme_bw()+
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
xlim(0,100)+
ylab("Cost of Transport (pgO2/mgC per zooid length moved)")+
xlab("Proportion of Metabolic Cost Spent on Swimming (%)")
wrap_plots(Sm6A, Sm6B)
glm(COT.p.ml ~ COT.abs.ml, data = COT_with_means %>%
filter(!is.na(COT.p.ml) & !is.na(Species) & Species != "Thalia sp."),
family = gaussian(link = "identity")) %>% summary()
glm(COT.p.ml ~ COT.rel.ml, data = COT__with_means %>%
filter(!is.na(COT.p.ml) & !is.na(Species) & Species != "Thalia sp."),
family = gaussian(link = "identity")) %>% summary()
glm(COT.p.ml ~ COT.rel.ml, data = COT_with_means %>%
filter(!is.na(COT.p.ml) & !is.na(Species) & Species != "Thalia sp."),
family = gaussian(link = "identity")) %>% summary()
# % cost (by biovolume) invested in swimming across basal rate , color: Species
ggplot(COT_species %>%  filter(!is.na(COT.p.ml)), aes(x = COL.abs.ml-COT.abs.ml,y=COT.p.ml))+
geom_point(aes(size=Zooid.length..mm.,color=Species))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
#ylim(c(0,100))+
ylab("% Cost of Transport Volume-normalized")+xlab("Basal rate")
# % cost (by biovolume) invested in swimming across basal rate , color: Species
ggplot(COT_species %>%  filter(!is.na(COT.p.ml)), aes(x = Slope_O2_dif_normalized_Anesthetized,y=COT.p.ml))+
geom_point(aes(size=Zooid.length..mm.,color=Species))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
#ylim(c(0,100))+
ylab("% Cost of Transport Volume-normalized")+xlab("Basal rate")
# % cost (by biovolume) invested in swimming across basal rate , color: Species
ggplot(COT_species %>%  filter(!is.na(COT.p.ml) & Species != "Thalia sp."), aes(x = Slope_O2_dif_normalized_Anesthetized,y=COT.p.ml))+
geom_point(aes(size=Zooid.length..mm.,color=Species))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
#ylim(c(0,100))+
ylab("% Cost of Transport Volume-normalized")+xlab("Basal rate")
COT_species$Slope_O2_dif_normalized_Anesthetized
# % cost (by biovolume) invested in swimming across basal rate , color: Species
ggplot(COT_species %>%  filter(!is.na(COT.p.ml) & Species != "Thalia sp."), aes(x = -Slope_O2_dif_normalized_Anesthetized,y=COT.p.ml))+
geom_point(aes(size=Zooid.length..mm.,color=Species))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
#ylim(c(0,100))+
ylab("% Cost of Transport Volume-normalized")+xlab("Basal rate")
# % cost (by biovolume) invested in swimming across species , color: Relative speed
ggplot(COT_species %>% filter(!is.na(COT.p.mgC)), aes(x=Species,y=COT.p.mgC))+
geom_point(aes(size=Speed.cm.s,color=Speed.body.s))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
#ylim(c(0,100))+
ylab("% Cost of Transport Carbon-normalized")
# % cost (by biovolume) invested in swimming across species , color: Relative speed
ggplot(COT_species %>% filter(!is.na(COT.p.mgC)), aes(x=Species,y=COT.p.mgC))+
geom_point(aes(size=Speed_mm_s,color=Speed.body.s))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
#ylim(c(0,100))+
ylab("% Cost of Transport Carbon-normalized")
# % cost (by biovolume) invested in swimming across species , color: Relative speed
ggplot(COT_species %>% filter(!is.na(COT.p.mgC)), aes(x=Species,y=COT.p.mgC))+
geom_point(aes(size=Speed_mm_s))+
theme_bw()+
theme(axis.text.x = element_text(angle = 90))+
#ylim(c(0,100))+
ylab("% Cost of Transport Carbon-normalized")
ggplot(COT_intact, aes(x=Speed.cm.s,y=COT.abs.ml))+
geom_point()+
theme_bw()+
geom_smooth(method="lm")+
ylab("Cost of Living (mgO2/ml per body length moved)")
COT_with_means %>% filter(!is.na(Species)) %>%
group_by(Species) %>%
summarise(
Nspecimens = n_distinct(Specimen),
Nmeasurements = n()
)
speed_annotated %>%
filter(!is.na(Species) & Architecture != "Whorl chain" & !is.na(BLperPulse)) %>%
group_by(Architecture) %>%
ggplot(aes(Zooid.number, BLperPulse)) +
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
geom_smooth(aes(color = Architecture), method = 'lm', se = TRUE) +  # Match color to Architecture
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
theme_bw() +
ylim(c(0, NA)) +
facet_wrap(~Architecture, scales = "free") +
ylab("Speed (Body lengths per pulse)") +xlab("Number of zooids") + guides(color = "none")
speed_annotated %>%
filter(!is.na(Species) & Architecture != "Whorl chain" & !is.na(BLperPulse)) %>% mutate(CSAmode = case_when(
Architecture %in% c("Transversal", "Cluster", "Whorl", "Oblique") ~ "Scaling Frontal Area",
Architecture %in% c("Linear", "Bipinnate", "Helical") ~ "Constant Frontal Area",
TRUE ~ as.character(Architecture)
)) %>%
group_by(CSAmode) %>%
ggplot(aes(Zooid.number, BLperPulse)) +
stat_summary(fun = mean, geom = "point", aes(col = Architecture), size = 3) +
stat_summary(fun.data = mean_se, geom = "errorbar", aes(col = Architecture), width = 0.2) +
scale_color_manual(values = c("Transversal" = "green4", "Oblique" = "red1", "Linear" = "darkorange1",
"Bipinnate" = "cyan4", "Helical" = "gold1", "Whorl" = "darkorchid4",
"Cluster" = "magenta")) +
geom_smooth(col = "black", method = 'lm', se = TRUE) +  # Add regression line
theme_bw() +
ylab("Speed (Body lengths per pulse)")+
xlab("Number of zooids")+
facet_wrap(~CSAmode, scales = "free_x")
